!function webpackUniversalModuleDefinition(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ImageTranslator=e():t.ImageTranslator=e()}(self,(()=>(()=>{var t,e,r,n,s={5836:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Container=void 0;e.Container=class Container{constructor(){this.providers=new Map}registerValue(t,e){this.providers.set(t,{type:"value",value:e})}registerClass(t,e,r=[]){this.providers.set(t,{type:"class",ctor:e,dependencies:r})}registerSingleton(t,e,r=[]){this.providers.set(t,{type:"singleton",ctor:e,dependencies:r})}registerFactory(t,e,r=[]){this.providers.set(t,{type:"factory",factory:e,dependencies:r})}resolve(t){const e=this.providers.get(t);if(!e)throw new Error(`Dependency ${t} not found`);if("value"===e.type)return e.value;if("class"===e.type)return this.instantiateClass(e);if("singleton"===e.type)return this.instantiateSingleton(e);if("factory"===e.type)return this.instantiateFactory(e);throw new Error(`Unsupported provider: ${t}`)}instantiateClass(t){const e=t.dependencies.map((t=>this.resolve(t)));return new t.ctor(...e)}instantiateSingleton(t){if(t.instance)return t.instance;const e=t.dependencies.map((t=>this.resolve(t)));return t.instance=new t.ctor(...e),t.instance}instantiateFactory(t){const e=t.dependencies.map((t=>this.resolve(t)));return t.factory(...e)}save(){this.snapshot=new Map(this.providers)}restore(){if(!this.snapshot)throw new Error("Empty snapshot");this.providers=new Map(this.snapshot),this.snapshot=void 0}}},2087:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(e,r);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,s)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),s=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),s(r(5836),e)},8168:(t,e,r)=>{const n=r(8874),s={};for(const t of Object.keys(n))s[n[t]]=t;const i={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};t.exports=i;for(const t of Object.keys(i)){if(!("channels"in i[t]))throw new Error("missing channels property: "+t);if(!("labels"in i[t]))throw new Error("missing channel labels property: "+t);if(i[t].labels.length!==i[t].channels)throw new Error("channel and label counts mismatch: "+t);const{channels:e,labels:r}=i[t];delete i[t].channels,delete i[t].labels,Object.defineProperty(i[t],"channels",{value:e}),Object.defineProperty(i[t],"labels",{value:r})}i.rgb.hsl=function(t){const e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.min(e,r,n),i=Math.max(e,r,n),a=i-s;let o,c;i===s?o=0:e===i?o=(r-n)/a:r===i?o=2+(n-e)/a:n===i&&(o=4+(e-r)/a),o=Math.min(60*o,360),o<0&&(o+=360);const l=(s+i)/2;return c=i===s?0:l<=.5?a/(i+s):a/(2-i-s),[o,100*c,100*l]},i.rgb.hsv=function(t){let e,r,n,s,i;const a=t[0]/255,o=t[1]/255,c=t[2]/255,l=Math.max(a,o,c),h=l-Math.min(a,o,c),diffc=function(t){return(l-t)/6/h+.5};return 0===h?(s=0,i=0):(i=h/l,e=diffc(a),r=diffc(o),n=diffc(c),a===l?s=n-r:o===l?s=1/3+e-n:c===l&&(s=2/3+r-e),s<0?s+=1:s>1&&(s-=1)),[360*s,100*i,100*l]},i.rgb.hwb=function(t){const e=t[0],r=t[1];let n=t[2];const s=i.rgb.hsl(t)[0],a=1/255*Math.min(e,Math.min(r,n));return n=1-1/255*Math.max(e,Math.max(r,n)),[s,100*a,100*n]},i.rgb.cmyk=function(t){const e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.min(1-e,1-r,1-n);return[100*((1-e-s)/(1-s)||0),100*((1-r-s)/(1-s)||0),100*((1-n-s)/(1-s)||0),100*s]},i.rgb.keyword=function(t){const e=s[t];if(e)return e;let r,i=1/0;for(const e of Object.keys(n)){const s=n[e],c=(o=s,((a=t)[0]-o[0])**2+(a[1]-o[1])**2+(a[2]-o[2])**2);c<i&&(i=c,r=e)}var a,o;return r},i.keyword.rgb=function(t){return n[t]},i.rgb.xyz=function(t){let e=t[0]/255,r=t[1]/255,n=t[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92;return[100*(.4124*e+.3576*r+.1805*n),100*(.2126*e+.7152*r+.0722*n),100*(.0193*e+.1192*r+.9505*n)]},i.rgb.lab=function(t){const e=i.rgb.xyz(t);let r=e[0],n=e[1],s=e[2];r/=95.047,n/=100,s/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,s=s>.008856?s**(1/3):7.787*s+16/116;return[116*n-16,500*(r-n),200*(n-s)]},i.hsl.rgb=function(t){const e=t[0]/360,r=t[1]/100,n=t[2]/100;let s,i,a;if(0===r)return a=255*n,[a,a,a];s=n<.5?n*(1+r):n+r-n*r;const o=2*n-s,c=[0,0,0];for(let t=0;t<3;t++)i=e+1/3*-(t-1),i<0&&i++,i>1&&i--,a=6*i<1?o+6*(s-o)*i:2*i<1?s:3*i<2?o+(s-o)*(2/3-i)*6:o,c[t]=255*a;return c},i.hsl.hsv=function(t){const e=t[0];let r=t[1]/100,n=t[2]/100,s=r;const i=Math.max(n,.01);n*=2,r*=n<=1?n:2-n,s*=i<=1?i:2-i;return[e,100*(0===n?2*s/(i+s):2*r/(n+r)),100*((n+r)/2)]},i.hsv.rgb=function(t){const e=t[0]/60,r=t[1]/100;let n=t[2]/100;const s=Math.floor(e)%6,i=e-Math.floor(e),a=255*n*(1-r),o=255*n*(1-r*i),c=255*n*(1-r*(1-i));switch(n*=255,s){case 0:return[n,c,a];case 1:return[o,n,a];case 2:return[a,n,c];case 3:return[a,o,n];case 4:return[c,a,n];case 5:return[n,a,o]}},i.hsv.hsl=function(t){const e=t[0],r=t[1]/100,n=t[2]/100,s=Math.max(n,.01);let i,a;a=(2-r)*n;const o=(2-r)*s;return i=r*s,i/=o<=1?o:2-o,i=i||0,a/=2,[e,100*i,100*a]},i.hwb.rgb=function(t){const e=t[0]/360;let r=t[1]/100,n=t[2]/100;const s=r+n;let i;s>1&&(r/=s,n/=s);const a=Math.floor(6*e),o=1-n;i=6*e-a,0!=(1&a)&&(i=1-i);const c=r+i*(o-r);let l,h,u;switch(a){default:case 6:case 0:l=o,h=c,u=r;break;case 1:l=c,h=o,u=r;break;case 2:l=r,h=o,u=c;break;case 3:l=r,h=c,u=o;break;case 4:l=c,h=r,u=o;break;case 5:l=o,h=r,u=c}return[255*l,255*h,255*u]},i.cmyk.rgb=function(t){const e=t[0]/100,r=t[1]/100,n=t[2]/100,s=t[3]/100;return[255*(1-Math.min(1,e*(1-s)+s)),255*(1-Math.min(1,r*(1-s)+s)),255*(1-Math.min(1,n*(1-s)+s))]},i.xyz.rgb=function(t){const e=t[0]/100,r=t[1]/100,n=t[2]/100;let s,i,a;return s=3.2406*e+-1.5372*r+-.4986*n,i=-.9689*e+1.8758*r+.0415*n,a=.0557*e+-.204*r+1.057*n,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,i=i>.0031308?1.055*i**(1/2.4)-.055:12.92*i,a=a>.0031308?1.055*a**(1/2.4)-.055:12.92*a,s=Math.min(Math.max(0,s),1),i=Math.min(Math.max(0,i),1),a=Math.min(Math.max(0,a),1),[255*s,255*i,255*a]},i.xyz.lab=function(t){let e=t[0],r=t[1],n=t[2];e/=95.047,r/=100,n/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;return[116*r-16,500*(e-r),200*(r-n)]},i.lab.xyz=function(t){let e,r,n;r=(t[0]+16)/116,e=t[1]/500+r,n=r-t[2]/200;const s=r**3,i=e**3,a=n**3;return r=s>.008856?s:(r-16/116)/7.787,e=i>.008856?i:(e-16/116)/7.787,n=a>.008856?a:(n-16/116)/7.787,e*=95.047,r*=100,n*=108.883,[e,r,n]},i.lab.lch=function(t){const e=t[0],r=t[1],n=t[2];let s;s=360*Math.atan2(n,r)/2/Math.PI,s<0&&(s+=360);return[e,Math.sqrt(r*r+n*n),s]},i.lch.lab=function(t){const e=t[0],r=t[1],n=t[2]/360*2*Math.PI;return[e,r*Math.cos(n),r*Math.sin(n)]},i.rgb.ansi16=function(t,e=null){const[r,n,s]=t;let a=null===e?i.rgb.hsv(t)[2]:e;if(a=Math.round(a/50),0===a)return 30;let o=30+(Math.round(s/255)<<2|Math.round(n/255)<<1|Math.round(r/255));return 2===a&&(o+=60),o},i.hsv.ansi16=function(t){return i.rgb.ansi16(i.hsv.rgb(t),t[2])},i.rgb.ansi256=function(t){const e=t[0],r=t[1],n=t[2];if(e===r&&r===n)return e<8?16:e>248?231:Math.round((e-8)/247*24)+232;return 16+36*Math.round(e/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5)},i.ansi16.rgb=function(t){let e=t%10;if(0===e||7===e)return t>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const r=.5*(1+~~(t>50));return[(1&e)*r*255,(e>>1&1)*r*255,(e>>2&1)*r*255]},i.ansi256.rgb=function(t){if(t>=232){const e=10*(t-232)+8;return[e,e,e]}let e;t-=16;return[Math.floor(t/36)/5*255,Math.floor((e=t%36)/6)/5*255,e%6/5*255]},i.rgb.hex=function(t){const e=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},i.hex.rgb=function(t){const e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let r=e[0];3===e[0].length&&(r=r.split("").map((t=>t+t)).join(""));const n=parseInt(r,16);return[n>>16&255,n>>8&255,255&n]},i.rgb.hcg=function(t){const e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(Math.max(e,r),n),i=Math.min(Math.min(e,r),n),a=s-i;let o,c;return o=a<1?i/(1-a):0,c=a<=0?0:s===e?(r-n)/a%6:s===r?2+(n-e)/a:4+(e-r)/a,c/=6,c%=1,[360*c,100*a,100*o]},i.hsl.hcg=function(t){const e=t[1]/100,r=t[2]/100,n=r<.5?2*e*r:2*e*(1-r);let s=0;return n<1&&(s=(r-.5*n)/(1-n)),[t[0],100*n,100*s]},i.hsv.hcg=function(t){const e=t[1]/100,r=t[2]/100,n=e*r;let s=0;return n<1&&(s=(r-n)/(1-n)),[t[0],100*n,100*s]},i.hcg.rgb=function(t){const e=t[0]/360,r=t[1]/100,n=t[2]/100;if(0===r)return[255*n,255*n,255*n];const s=[0,0,0],i=e%1*6,a=i%1,o=1-a;let c=0;switch(Math.floor(i)){case 0:s[0]=1,s[1]=a,s[2]=0;break;case 1:s[0]=o,s[1]=1,s[2]=0;break;case 2:s[0]=0,s[1]=1,s[2]=a;break;case 3:s[0]=0,s[1]=o,s[2]=1;break;case 4:s[0]=a,s[1]=0,s[2]=1;break;default:s[0]=1,s[1]=0,s[2]=o}return c=(1-r)*n,[255*(r*s[0]+c),255*(r*s[1]+c),255*(r*s[2]+c)]},i.hcg.hsv=function(t){const e=t[1]/100,r=e+t[2]/100*(1-e);let n=0;return r>0&&(n=e/r),[t[0],100*n,100*r]},i.hcg.hsl=function(t){const e=t[1]/100,r=t[2]/100*(1-e)+.5*e;let n=0;return r>0&&r<.5?n=e/(2*r):r>=.5&&r<1&&(n=e/(2*(1-r))),[t[0],100*n,100*r]},i.hcg.hwb=function(t){const e=t[1]/100,r=e+t[2]/100*(1-e);return[t[0],100*(r-e),100*(1-r)]},i.hwb.hcg=function(t){const e=t[1]/100,r=1-t[2]/100,n=r-e;let s=0;return n<1&&(s=(r-n)/(1-n)),[t[0],100*n,100*s]},i.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},i.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},i.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},i.gray.hsl=function(t){return[0,0,t[0]]},i.gray.hsv=i.gray.hsl,i.gray.hwb=function(t){return[0,100,t[0]]},i.gray.cmyk=function(t){return[0,0,0,t[0]]},i.gray.lab=function(t){return[t[0],0,0]},i.gray.hex=function(t){const e=255&Math.round(t[0]/100*255),r=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(r.length)+r},i.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}},2085:(t,e,r)=>{const n=r(8168),s=r(4111),i={};Object.keys(n).forEach((t=>{i[t]={},Object.defineProperty(i[t],"channels",{value:n[t].channels}),Object.defineProperty(i[t],"labels",{value:n[t].labels});const e=s(t);Object.keys(e).forEach((r=>{const n=e[r];i[t][r]=function wrapRounded(t){const wrappedFn=function(...e){const r=e[0];if(null==r)return r;r.length>1&&(e=r);const n=t(e);if("object"==typeof n)for(let t=n.length,e=0;e<t;e++)n[e]=Math.round(n[e]);return n};return"conversion"in t&&(wrappedFn.conversion=t.conversion),wrappedFn}(n),i[t][r].raw=function wrapRaw(t){const wrappedFn=function(...e){const r=e[0];return null==r?r:(r.length>1&&(e=r),t(e))};return"conversion"in t&&(wrappedFn.conversion=t.conversion),wrappedFn}(n)}))})),t.exports=i},4111:(t,e,r)=>{const n=r(8168);function deriveBFS(t){const e=function buildGraph(){const t={},e=Object.keys(n);for(let r=e.length,n=0;n<r;n++)t[e[n]]={distance:-1,parent:null};return t}(),r=[t];for(e[t].distance=0;r.length;){const t=r.pop(),s=Object.keys(n[t]);for(let n=s.length,i=0;i<n;i++){const n=s[i],a=e[n];-1===a.distance&&(a.distance=e[t].distance+1,a.parent=t,r.unshift(n))}}return e}function link(t,e){return function(r){return e(t(r))}}function wrapConversion(t,e){const r=[e[t].parent,t];let s=n[e[t].parent][t],i=e[t].parent;for(;e[i].parent;)r.unshift(e[i].parent),s=link(n[e[i].parent][i],s),i=e[i].parent;return s.conversion=r,s}t.exports=function(t){const e=deriveBFS(t),r={},n=Object.keys(e);for(let t=n.length,s=0;s<t;s++){const t=n[s];null!==e[t].parent&&(r[t]=wrapConversion(t,e))}return r}},8874:t=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},1989:(t,e,r)=>{var n=r(1789),s=r(401),i=r(7667),a=r(1327),o=r(1866);function Hash(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Hash.prototype.clear=n,Hash.prototype.delete=s,Hash.prototype.get=i,Hash.prototype.has=a,Hash.prototype.set=o,t.exports=Hash},8407:(t,e,r)=>{var n=r(7040),s=r(4125),i=r(2117),a=r(7518),o=r(4705);function ListCache(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ListCache.prototype.clear=n,ListCache.prototype.delete=s,ListCache.prototype.get=i,ListCache.prototype.has=a,ListCache.prototype.set=o,t.exports=ListCache},7071:(t,e,r)=>{var n=r(852)(r(5639),"Map");t.exports=n},3369:(t,e,r)=>{var n=r(4785),s=r(1285),i=r(6e3),a=r(9916),o=r(5265);function MapCache(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}MapCache.prototype.clear=n,MapCache.prototype.delete=s,MapCache.prototype.get=i,MapCache.prototype.has=a,MapCache.prototype.set=o,t.exports=MapCache},6384:(t,e,r)=>{var n=r(8407),s=r(7465),i=r(3779),a=r(7599),o=r(4758),c=r(4309);function Stack(t){var e=this.__data__=new n(t);this.size=e.size}Stack.prototype.clear=s,Stack.prototype.delete=i,Stack.prototype.get=a,Stack.prototype.has=o,Stack.prototype.set=c,t.exports=Stack},2705:(t,e,r)=>{var n=r(5639).Symbol;t.exports=n},1149:(t,e,r)=>{var n=r(5639).Uint8Array;t.exports=n},6874:t=>{t.exports=function apply(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}},4636:(t,e,r)=>{var n=r(2545),s=r(5694),i=r(1469),a=r(4144),o=r(5776),c=r(6719),l=Object.prototype.hasOwnProperty;t.exports=function arrayLikeKeys(t,e){var r=i(t),h=!r&&s(t),u=!r&&!h&&a(t),d=!r&&!h&&!u&&c(t),g=r||h||u||d,p=g?n(t.length,String):[],f=p.length;for(var m in t)!e&&!l.call(t,m)||g&&("length"==m||u&&("offset"==m||"parent"==m)||d&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||o(m,f))||p.push(m);return p}},6556:(t,e,r)=>{var n=r(9465),s=r(7813);t.exports=function assignMergeValue(t,e,r){(void 0!==r&&!s(t[e],r)||void 0===r&&!(e in t))&&n(t,e,r)}},4865:(t,e,r)=>{var n=r(9465),s=r(7813),i=Object.prototype.hasOwnProperty;t.exports=function assignValue(t,e,r){var a=t[e];i.call(t,e)&&s(a,r)&&(void 0!==r||e in t)||n(t,e,r)}},8470:(t,e,r)=>{var n=r(7813);t.exports=function assocIndexOf(t,e){for(var r=t.length;r--;)if(n(t[r][0],e))return r;return-1}},9465:(t,e,r)=>{var n=r(8777);t.exports=function baseAssignValue(t,e,r){"__proto__"==e&&n?n(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}},9750:t=>{t.exports=function baseClamp(t,e,r){return t==t&&(void 0!==r&&(t=t<=r?t:r),void 0!==e&&(t=t>=e?t:e)),t}},3118:(t,e,r)=>{var n=r(3218),s=Object.create,i=function(){function object(){}return function(t){if(!n(t))return{};if(s)return s(t);object.prototype=t;var e=new object;return object.prototype=void 0,e}}();t.exports=i},8483:(t,e,r)=>{var n=r(5063)();t.exports=n},4239:(t,e,r)=>{var n=r(2705),s=r(9607),i=r(2333),a=n?n.toStringTag:void 0;t.exports=function baseGetTag(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?s(t):i(t)}},9454:(t,e,r)=>{var n=r(4239),s=r(7005);t.exports=function baseIsArguments(t){return s(t)&&"[object Arguments]"==n(t)}},8458:(t,e,r)=>{var n=r(3560),s=r(5346),i=r(3218),a=r(346),o=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,h=c.toString,u=l.hasOwnProperty,d=RegExp("^"+h.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function baseIsNative(t){return!(!i(t)||s(t))&&(n(t)?d:o).test(a(t))}},8749:(t,e,r)=>{var n=r(4239),s=r(1780),i=r(7005),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function baseIsTypedArray(t){return i(t)&&s(t.length)&&!!a[n(t)]}},313:(t,e,r)=>{var n=r(3218),s=r(5726),i=r(3498),a=Object.prototype.hasOwnProperty;t.exports=function baseKeysIn(t){if(!n(t))return i(t);var e=s(t),r=[];for(var o in t)("constructor"!=o||!e&&a.call(t,o))&&r.push(o);return r}},2980:(t,e,r)=>{var n=r(6384),s=r(6556),i=r(8483),a=r(9783),o=r(3218),c=r(1704),l=r(6390);t.exports=function baseMerge(t,e,r,h,u){t!==e&&i(e,(function(i,c){if(u||(u=new n),o(i))a(t,e,c,r,baseMerge,h,u);else{var d=h?h(l(t,c),i,c+"",t,e,u):void 0;void 0===d&&(d=i),s(t,c,d)}}),c)}},9783:(t,e,r)=>{var n=r(6556),s=r(4626),i=r(7133),a=r(278),o=r(8517),c=r(5694),l=r(1469),h=r(9246),u=r(4144),d=r(3560),g=r(3218),p=r(8630),f=r(6719),m=r(6390),y=r(9881);t.exports=function baseMergeDeep(t,e,r,v,x,b,w){var _=m(t,r),k=m(e,r),C=w.get(k);if(C)n(t,r,C);else{var M=b?b(_,k,r+"",t,e,w):void 0,T=void 0===M;if(T){var L=l(k),S=!L&&u(k),B=!L&&!S&&f(k);M=k,L||S||B?l(_)?M=_:h(_)?M=a(_):S?(T=!1,M=s(k,!0)):B?(T=!1,M=i(k,!0)):M=[]:p(k)||c(k)?(M=_,c(_)?M=y(_):g(_)&&!d(_)||(M=o(k))):T=!1}T&&(w.set(k,M),x(M,k,v,b,w),w.delete(k)),n(t,r,M)}}},5976:(t,e,r)=>{var n=r(6557),s=r(5357),i=r(61);t.exports=function baseRest(t,e){return i(s(t,e,n),t+"")}},6560:(t,e,r)=>{var n=r(5703),s=r(8777),i=r(6557),a=s?function(t,e){return s(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:i;t.exports=a},2545:t=>{t.exports=function baseTimes(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}},7561:(t,e,r)=>{var n=r(7990),s=/^\s+/;t.exports=function baseTrim(t){return t?t.slice(0,n(t)+1).replace(s,""):t}},1717:t=>{t.exports=function baseUnary(t){return function(e){return t(e)}}},4318:(t,e,r)=>{var n=r(1149);t.exports=function cloneArrayBuffer(t){var e=new t.constructor(t.byteLength);return new n(e).set(new n(t)),e}},4626:(t,e,r)=>{t=r.nmd(t);var n=r(5639),s=e&&!e.nodeType&&e,i=s&&t&&!t.nodeType&&t,a=i&&i.exports===s?n.Buffer:void 0,o=a?a.allocUnsafe:void 0;t.exports=function cloneBuffer(t,e){if(e)return t.slice();var r=t.length,n=o?o(r):new t.constructor(r);return t.copy(n),n}},7133:(t,e,r)=>{var n=r(4318);t.exports=function cloneTypedArray(t,e){var r=e?n(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}},278:t=>{t.exports=function copyArray(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}},8363:(t,e,r)=>{var n=r(4865),s=r(9465);t.exports=function copyObject(t,e,r,i){var a=!r;r||(r={});for(var o=-1,c=e.length;++o<c;){var l=e[o],h=i?i(r[l],t[l],l,r,t):void 0;void 0===h&&(h=t[l]),a?s(r,l,h):n(r,l,h)}return r}},4429:(t,e,r)=>{var n=r(5639)["__core-js_shared__"];t.exports=n},1463:(t,e,r)=>{var n=r(5976),s=r(6612);t.exports=function createAssigner(t){return n((function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(a=t.length>3&&"function"==typeof a?(i--,a):void 0,o&&s(r[0],r[1],o)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var c=r[n];c&&t(e,c,n,a)}return e}))}},5063:t=>{t.exports=function createBaseFor(t){return function(e,r,n){for(var s=-1,i=Object(e),a=n(e),o=a.length;o--;){var c=a[t?o:++s];if(!1===r(i[c],c,i))break}return e}}},8777:(t,e,r)=>{var n=r(852),s=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=s},1957:(t,e,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;t.exports=n},5050:(t,e,r)=>{var n=r(7019);t.exports=function getMapData(t,e){var r=t.__data__;return n(e)?r["string"==typeof e?"string":"hash"]:r.map}},852:(t,e,r)=>{var n=r(8458),s=r(7801);t.exports=function getNative(t,e){var r=s(t,e);return n(r)?r:void 0}},5924:(t,e,r)=>{var n=r(5569)(Object.getPrototypeOf,Object);t.exports=n},9607:(t,e,r)=>{var n=r(2705),s=Object.prototype,i=s.hasOwnProperty,a=s.toString,o=n?n.toStringTag:void 0;t.exports=function getRawTag(t){var e=i.call(t,o),r=t[o];try{t[o]=void 0;var n=!0}catch(t){}var s=a.call(t);return n&&(e?t[o]=r:delete t[o]),s}},7801:t=>{t.exports=function getValue(t,e){return null==t?void 0:t[e]}},1789:(t,e,r)=>{var n=r(4536);t.exports=function hashClear(){this.__data__=n?n(null):{},this.size=0}},401:t=>{t.exports=function hashDelete(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},7667:(t,e,r)=>{var n=r(4536),s=Object.prototype.hasOwnProperty;t.exports=function hashGet(t){var e=this.__data__;if(n){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return s.call(e,t)?e[t]:void 0}},1327:(t,e,r)=>{var n=r(4536),s=Object.prototype.hasOwnProperty;t.exports=function hashHas(t){var e=this.__data__;return n?void 0!==e[t]:s.call(e,t)}},1866:(t,e,r)=>{var n=r(4536);t.exports=function hashSet(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=n&&void 0===e?"__lodash_hash_undefined__":e,this}},8517:(t,e,r)=>{var n=r(3118),s=r(5924),i=r(5726);t.exports=function initCloneObject(t){return"function"!=typeof t.constructor||i(t)?{}:n(s(t))}},5776:t=>{var e=/^(?:0|[1-9]\d*)$/;t.exports=function isIndex(t,r){var n=typeof t;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&e.test(t))&&t>-1&&t%1==0&&t<r}},6612:(t,e,r)=>{var n=r(7813),s=r(8612),i=r(5776),a=r(3218);t.exports=function isIterateeCall(t,e,r){if(!a(r))return!1;var o=typeof e;return!!("number"==o?s(r)&&i(e,r.length):"string"==o&&e in r)&&n(r[e],t)}},7019:t=>{t.exports=function isKeyable(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},5346:(t,e,r)=>{var n,s=r(4429),i=(n=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function isMasked(t){return!!i&&i in t}},5726:t=>{var e=Object.prototype;t.exports=function isPrototype(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||e)}},7040:t=>{t.exports=function listCacheClear(){this.__data__=[],this.size=0}},4125:(t,e,r)=>{var n=r(8470),s=Array.prototype.splice;t.exports=function listCacheDelete(t){var e=this.__data__,r=n(e,t);return!(r<0)&&(r==e.length-1?e.pop():s.call(e,r,1),--this.size,!0)}},2117:(t,e,r)=>{var n=r(8470);t.exports=function listCacheGet(t){var e=this.__data__,r=n(e,t);return r<0?void 0:e[r][1]}},7518:(t,e,r)=>{var n=r(8470);t.exports=function listCacheHas(t){return n(this.__data__,t)>-1}},4705:(t,e,r)=>{var n=r(8470);t.exports=function listCacheSet(t,e){var r=this.__data__,s=n(r,t);return s<0?(++this.size,r.push([t,e])):r[s][1]=e,this}},4785:(t,e,r)=>{var n=r(1989),s=r(8407),i=r(7071);t.exports=function mapCacheClear(){this.size=0,this.__data__={hash:new n,map:new(i||s),string:new n}}},1285:(t,e,r)=>{var n=r(5050);t.exports=function mapCacheDelete(t){var e=n(this,t).delete(t);return this.size-=e?1:0,e}},6e3:(t,e,r)=>{var n=r(5050);t.exports=function mapCacheGet(t){return n(this,t).get(t)}},9916:(t,e,r)=>{var n=r(5050);t.exports=function mapCacheHas(t){return n(this,t).has(t)}},5265:(t,e,r)=>{var n=r(5050);t.exports=function mapCacheSet(t,e){var r=n(this,t),s=r.size;return r.set(t,e),this.size+=r.size==s?0:1,this}},4536:(t,e,r)=>{var n=r(852)(Object,"create");t.exports=n},3498:t=>{t.exports=function nativeKeysIn(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}},1167:(t,e,r)=>{t=r.nmd(t);var n=r(1957),s=e&&!e.nodeType&&e,i=s&&t&&!t.nodeType&&t,a=i&&i.exports===s&&n.process,o=function(){try{var t=i&&i.require&&i.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=o},2333:t=>{var e=Object.prototype.toString;t.exports=function objectToString(t){return e.call(t)}},5569:t=>{t.exports=function overArg(t,e){return function(r){return t(e(r))}}},5357:(t,e,r)=>{var n=r(6874),s=Math.max;t.exports=function overRest(t,e,r){return e=s(void 0===e?t.length-1:e,0),function(){for(var i=arguments,a=-1,o=s(i.length-e,0),c=Array(o);++a<o;)c[a]=i[e+a];a=-1;for(var l=Array(e+1);++a<e;)l[a]=i[a];return l[e]=r(c),n(t,this,l)}}},5639:(t,e,r)=>{var n=r(1957),s="object"==typeof self&&self&&self.Object===Object&&self,i=n||s||Function("return this")();t.exports=i},6390:t=>{t.exports=function safeGet(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},61:(t,e,r)=>{var n=r(6560),s=r(1275)(n);t.exports=s},1275:t=>{var e=Date.now;t.exports=function shortOut(t){var r=0,n=0;return function(){var s=e(),i=16-(s-n);if(n=s,i>0){if(++r>=800)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}},7465:(t,e,r)=>{var n=r(8407);t.exports=function stackClear(){this.__data__=new n,this.size=0}},3779:t=>{t.exports=function stackDelete(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}},7599:t=>{t.exports=function stackGet(t){return this.__data__.get(t)}},4758:t=>{t.exports=function stackHas(t){return this.__data__.has(t)}},4309:(t,e,r)=>{var n=r(8407),s=r(7071),i=r(3369);t.exports=function stackSet(t,e){var r=this.__data__;if(r instanceof n){var a=r.__data__;if(!s||a.length<199)return a.push([t,e]),this.size=++r.size,this;r=this.__data__=new i(a)}return r.set(t,e),this.size=r.size,this}},346:t=>{var e=Function.prototype.toString;t.exports=function toSource(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},7990:t=>{var e=/\s/;t.exports=function trimmedEndIndex(t){for(var r=t.length;r--&&e.test(t.charAt(r)););return r}},4691:(t,e,r)=>{var n=r(9750),s=r(4841);t.exports=function clamp(t,e,r){return void 0===r&&(r=e,e=void 0),void 0!==r&&(r=(r=s(r))==r?r:0),void 0!==e&&(e=(e=s(e))==e?e:0),n(s(t),e,r)}},5703:t=>{t.exports=function constant(t){return function(){return t}}},7813:t=>{t.exports=function eq(t,e){return t===e||t!=t&&e!=e}},6557:t=>{t.exports=function identity(t){return t}},5694:(t,e,r)=>{var n=r(9454),s=r(7005),i=Object.prototype,a=i.hasOwnProperty,o=i.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(t){return s(t)&&a.call(t,"callee")&&!o.call(t,"callee")};t.exports=c},1469:t=>{var e=Array.isArray;t.exports=e},8612:(t,e,r)=>{var n=r(3560),s=r(1780);t.exports=function isArrayLike(t){return null!=t&&s(t.length)&&!n(t)}},9246:(t,e,r)=>{var n=r(8612),s=r(7005);t.exports=function isArrayLikeObject(t){return s(t)&&n(t)}},4144:(t,e,r)=>{t=r.nmd(t);var n=r(5639),s=r(5062),i=e&&!e.nodeType&&e,a=i&&t&&!t.nodeType&&t,o=a&&a.exports===i?n.Buffer:void 0,c=(o?o.isBuffer:void 0)||s;t.exports=c},3560:(t,e,r)=>{var n=r(4239),s=r(3218);t.exports=function isFunction(t){if(!s(t))return!1;var e=n(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},1780:t=>{t.exports=function isLength(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},3218:t=>{t.exports=function isObject(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},7005:t=>{t.exports=function isObjectLike(t){return null!=t&&"object"==typeof t}},8630:(t,e,r)=>{var n=r(4239),s=r(5924),i=r(7005),a=Function.prototype,o=Object.prototype,c=a.toString,l=o.hasOwnProperty,h=c.call(Object);t.exports=function isPlainObject(t){if(!i(t)||"[object Object]"!=n(t))return!1;var e=s(t);if(null===e)return!0;var r=l.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&c.call(r)==h}},3448:(t,e,r)=>{var n=r(4239),s=r(7005);t.exports=function isSymbol(t){return"symbol"==typeof t||s(t)&&"[object Symbol]"==n(t)}},6719:(t,e,r)=>{var n=r(8749),s=r(1717),i=r(1167),a=i&&i.isTypedArray,o=a?s(a):n;t.exports=o},1704:(t,e,r)=>{var n=r(4636),s=r(313),i=r(8612);t.exports=function keysIn(t){return i(t)?n(t,!0):s(t)}},2492:(t,e,r)=>{var n=r(2980),s=r(1463)((function(t,e,r){n(t,e,r)}));t.exports=s},5062:t=>{t.exports=function stubFalse(){return!1}},4841:(t,e,r)=>{var n=r(7561),s=r(3218),i=r(3448),a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;t.exports=function toNumber(t){if("number"==typeof t)return t;if(i(t))return NaN;if(s(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=s(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=n(t);var r=o.test(t);return r||c.test(t)?l(t.slice(2),r?2:8):a.test(t)?NaN:+t}},9881:(t,e,r)=>{var n=r(8363),s=r(1704);t.exports=function toPlainObject(t){return n(t,s(t))}}},i={};function __webpack_require__(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={id:t,loaded:!1,exports:{}};return s[t].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.m=s,__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,__webpack_require__.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"==typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"==typeof r.then)return r}var s=Object.create(null);__webpack_require__.r(s);var i={};t=t||[null,e({}),e([]),e(e)];for(var a=2&n&&r;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>r[t]));return i.default=()=>r,__webpack_require__.d(s,i),s},__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.f={},__webpack_require__.e=t=>Promise.all(Object.keys(__webpack_require__.f).reduce(((e,r)=>(__webpack_require__.f[r](t,e),e)),[])),__webpack_require__.u=t=>({44:"hyphen-be",69:"hyphen-it",107:"hyphen-fr",357:"hyphen-uk",487:"hyphen-de",731:"hyphen-en",737:"hyphen-es",989:"hyphen-ru"}[t]+".js"),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r={},n="ImageTranslator:",__webpack_require__.l=(t,e,s,i)=>{if(r[t])r[t].push(e);else{var a,o;if(void 0!==s)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var h=c[l];if(h.getAttribute("src")==t||h.getAttribute("data-webpack")==n+s){a=h;break}}a||(o=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.setAttribute("data-webpack",n+s),a.src=t),r[t]=[e];var onScriptComplete=(e,n)=>{a.onerror=a.onload=null,clearTimeout(u);var s=r[t];if(delete r[t],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((t=>t(n))),e)return e(n)},u=setTimeout(onScriptComplete.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=onScriptComplete.bind(null,a.onerror),a.onload=onScriptComplete.bind(null,a.onload),o&&document.head.appendChild(a)}},__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;__webpack_require__.g.importScripts&&(t=__webpack_require__.g.location+"");var e=__webpack_require__.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&!t;)t=r[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=t})(),(()=>{var t={179:0};__webpack_require__.f.j=(e,r)=>{var n=__webpack_require__.o(t,e)?t[e]:void 0;if(0!==n)if(n)r.push(n[2]);else{var s=new Promise(((r,s)=>n=t[e]=[r,s]));r.push(n[2]=s);var i=__webpack_require__.p+__webpack_require__.u(e),a=new Error;__webpack_require__.l(i,(r=>{if(__webpack_require__.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var s=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;a.message="Loading chunk "+e+" failed.\n("+s+": "+i+")",a.name="ChunkLoadError",a.type=s,a.request=i,n[1](a)}}),"chunk-"+e,e)}};var webpackJsonpCallback=(e,r)=>{var n,s,[i,a,o]=r,c=0;if(i.some((e=>0!==t[e]))){for(n in a)__webpack_require__.o(a,n)&&(__webpack_require__.m[n]=a[n]);if(o)o(__webpack_require__)}for(e&&e(r);c<i.length;c++)s=i[c],__webpack_require__.o(t,s)&&t[s]&&t[s][0](),t[s]=0},e=self.webpackChunkImageTranslator=self.webpackChunkImageTranslator||[];e.forEach(webpackJsonpCallback.bind(null,0)),e.push=webpackJsonpCallback.bind(null,e.push.bind(e))})();var a={};return(()=>{"use strict";__webpack_require__.d(a,{default:()=>Application});var t=__webpack_require__(2492),e=__webpack_require__.n(t);const r={input:void 0,ocr:{endpoint:"https://translate.yandex.net/ocr/v1.1/recognize",erasedImagesHost:"https://ocrapi-text-erasure.s3.yandex.net",srv:"tr-image",imageQuality:.9,imageFormat:"image/webp",maxImageWidth:1024,grayscale:!1},translate:{endpoint:"https://translate.yandex.net/api/v1/tr.json/translate",detectEndpoint:"https://translate.yandex.net/api/v1/tr.json/detect",srv:"tr-image",format:"html"},textBalancer:{rearrangePairsAttempts:10,rearrangeTriplesAttempts:4},textSizer:{minTextSize:3,maxTextSize:120,precision:.1,xHeightRatio:1},rendering:{blurRadius:2,boxHeightRatio:2,boxWidthRatio:.5,pathSegmentCount:10,minTextSize:4,defaultTextSize:16,font:"'YS Text Condensed', 'YS Display', Roboto, -apple-system, BlinkMacSystemFont, Arial, sans-serif",wordColor:"rgba(50, 180, 255, 0.25)",wordHighlightColor:"rgba(255, 204, 0, 0.25)",svgBasedRenderingLanguages:["ar","fa","he","ur","yi"],textStrokeSize:5},logging:{enabled:!0},experiments:{detectBlocksLanguage:!1,useBlurTextErasure:!1,isLLMTranslationEnabled:!1},hyphenation:{enabled:!0,minLinesThreshold:5},blocksFilter:{enabled:!1},blocksAnalyzer:{yIntersectionThreshold:.8},wordsFinder:{tolerance:8}};var n=__webpack_require__(2087);class BlocksAnalyzerImpl{constructor(t,e){this.config=t,this.logger=e}isWellFormedBlock(t){if(t.boxes.length<=1)return!0;const e=[...t.boxes].sort(((t,e)=>t.top-e.top));let r;for(const n of e){if(!r||r.bottom<n.top){r=n;continue}const e=Math.max(r.bottom,n.bottom)-Math.min(r.top,n.top),s=Math.min(r.bottom,n.bottom)-Math.max(r.top,n.top);if(s/e>this.config.blocksAnalyzer.yIntersectionThreshold)return this.logger.warn("Malformed block found",{block:t,boxes:[r,n],yCommonLength:e,yIntersectionLength:s}),!1;r=n}return!0}}var __awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class BlocksProcessorImpl{constructor(t,e,r,n){this.config=t,this.blocksFilter=e,this.textContrastEnhancer=r,this.textStacker=n}getComponents(){const t=[];return this.config.blocksFilter.enabled&&t.push(this.blocksFilter),t.push(this.textContrastEnhancer),t.push(this.textStacker),t}process(t,e){return this.getComponents().reduce(((t,r)=>__awaiter(this,void 0,void 0,(function*(){return r.process(yield t,e)}))),Promise.resolve(t))}}class Rect{constructor(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}centerX(){return this.x+this.width/2}centerY(){return this.y+this.height/2}getValue(){return[this.x,this.y,this.width,this.height]}intersects(t){return this.x<=t.right&&this.y<=t.bottom&&this.right>=t.x&&this.bottom>=t.y}}class Block extends Rect{constructor(t){super(t),this.boxes=t.boxes,this.columnIndex=t.columnIndex}toString(){return this.boxes.map((t=>t.translation)).join("\n")}}const s={"<":"lt",">":"gt","&":"amp","'":"apos",'"':"quot"},i={lt:"<",gt:">",amp:"&",apos:"'",quot:'"'},o=/&([a-zA-Z0-9]+);/g;function encodeHtml(t){let e="";for(let r=0;r<t.length;r++){const n=t.charAt(r),i=s[n];e+=i?`&${i};`:n}return e}function decodeHtml(t){if(!t)return t;let e="",r=0,n=o.exec(t);for(;n;){const s=n[1],a=i[s];a&&(e+=t.substring(r,n.index),e+=a,r=n.index+n[0].length),n=o.exec(t)}return e+=t.substring(r),e}function median(t){const e=[...t].sort(((t,e)=>t-e)),r=e.length,n=Math.floor(r/2);return r%2==0?(e[n-1]+e[n])/2:e[n]}function clamp(t,e,r){return Math.min(Math.max(t,e),r)}class Color{constructor(t){this.a=1,this.r=clamp(t.r,0,255),this.g=clamp(t.g,0,255),this.b=clamp(t.b,0,255),void 0!==t.a&&(this.a=clamp(t.a,0,1))}toRgba(){return`rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`}luminance(){return.2126729*this.simpleExp(this.r)+.7151522*this.simpleExp(this.g)+.072175*this.simpleExp(this.b)}simpleExp(t){return Math.pow(t/255,2.4)}multiply(t){const e=255/Math.max(this.r,this.g,this.b),r=Math.min(t,e);return new Color({r:Math.floor(clamp(this.r*r,0,255)),g:Math.floor(clamp(this.g*r,0,255)),b:Math.floor(clamp(this.b*r,0,255))})}toRGB(){return[this.r,this.g,this.b]}static colorFromRGB(t,e){return new Color({r:t[0],g:t[1],b:t[2],a:null!=e?e:1})}}class Box extends Rect{constructor(t){super(t),this.backgroundColor=Box.DEFAULT_BACKGROUND,this.textColor=Box.DEFAULT_FOREGROUND,this.translation="",this.outlineColor=Box.DEFAULT_OUTLINE,this.text=t.text,this.words=t.words;const{polyCoefs:e,backgroundColor:r,textColor:n,translation:s,textSize:i,outlineColor:a}=t;this.polyCoefs=null!=e?e:this.polyCoefs,this.backgroundColor=null!=r?r:this.backgroundColor,this.textColor=null!=n?n:this.textColor,this.translation=null!=s?s:this.translation,this.textSize=null!=i?i:this.textSize,this.outlineColor=null!=a?a:this.outlineColor}intersectsByPolyCoeffs(t,e){var r,n;const s=((null===(r=this.polyCoefs)||void 0===r?void 0:r.hh)||0)*e,i=((null===(n=this.polyCoefs)||void 0===n?void 0:n.hh)||0)/2;return this.x<=t.right+s&&this.y<=t.bottom+i&&this.right>=t.x-s&&this.bottom>=t.y-i}}Box.DEFAULT_FOREGROUND=new Color({r:0,g:0,b:0}),Box.DEFAULT_BACKGROUND=new Color({r:255,g:255,b:255}),Box.DEFAULT_OUTLINE=new Color({r:255,g:255,b:255,a:0});class Point{constructor(t){this.x=t.x,this.y=t.y}}class PolyCoefs{constructor(t){this.a0=0,this.a1=0,this.a2=0,this.a3=0,this.hh=0,this.fromXtoY=!1,this.a0=t.a0,this.a1=t.a1,this.a2=t.a2,this.a3=t.a3,this.hh=t.hh,this.fromXtoY=t.fromXtoY}calcValue(t){return this.a3*Math.pow(t,3)+this.a2*Math.pow(t,2)+this.a1*t+this.a0}calcDerivative(t){return 3*this.a3*Math.pow(t,2)+2*this.a2*t+this.a1}calcTextAngle(t){const e=this.calcDerivative(t);return Math.atan(e)}}class Word extends Rect{constructor(t){var e;super(t),this.text=t.text,this.polyCoefs=null!==(e=t.polyCoefs)&&void 0!==e?e:this.polyCoefs}}class BlocksFilter{process(t){return t.map((t=>this.processBlock(t))).filter((t=>t.boxes.length>0))}processBlock(t){const e=t.boxes.filter((t=>this.hasTextOrEmpty(t)));return new Block(Object.assign(Object.assign({},t),{boxes:e}))}hasTextOrEmpty(t){return""===t.translation||/\D+/.test(t.translation)}}var c=__webpack_require__(2085);const l=1e-5,h=new class ApcaUtils{constructor(){this.FLIP_YS=.342,this.BLK_THRS=.022,this.BLK_CLMP=1.414,this.NORM_BG=.56,this.NORM_TXT=.57,this.REV_TXT=.62,this.REV_BG=.65,this.SCALE_BOW=1.14,this.SCALE_WOB=1.14,this.LO_BOW_OFFSET=.027,this.LO_WOB_OFFSET=.027,this.DELTA_Y_MIN=5e-4,this.LO_CLIP=.1}isDarkColor(t){return t.luminance()<this.FLIP_YS}calculateContrast(t,e){const r=t.luminance(),n=e.luminance();return this.calculateContrastBetweenLuminances(r,n)}calculateContrastBetweenLuminances(t,e){const r=t>this.BLK_THRS?t:t+Math.pow(this.BLK_THRS-t,this.BLK_CLMP),n=e>this.BLK_THRS?e:e+Math.pow(this.BLK_THRS-e,this.BLK_CLMP);if(Math.abs(n-r)<this.DELTA_Y_MIN)return 0;let s,i;return n>r?(s=(Math.pow(n,this.NORM_BG)-Math.pow(r,this.NORM_TXT))*this.SCALE_BOW,i=s<this.LO_CLIP?0:s-this.LO_BOW_OFFSET):(s=(Math.pow(n,this.REV_BG)-Math.pow(r,this.REV_TXT))*this.SCALE_WOB,i=s>-this.LO_CLIP?0:s+this.LO_WOB_OFFSET),100*i}},u=new Color({r:255,g:255,b:255,a:.25}),d=new Color({r:0,g:0,b:0,a:.25});class TextContrastEnhancerImpl{process(t){return t.map((t=>this.processBlock(t)))}processBlock(t){const e=t.boxes.map((t=>{const e=this.increaseForegroundContrast(t.textColor,t.backgroundColor),r=h.isDarkColor(e)?u:d;return new Box(Object.assign(Object.assign({},t),{textColor:e,outlineColor:r}))}));return new Block(Object.assign(Object.assign({},t),{boxes:e}))}increaseForegroundContrast(t,e){return h.calculateContrast(t,e)>=60?t:t.luminance()>e.luminance()?this.findContrastColorAgainstDark(t,e):this.findContrastColorAgainstLight(t,e)}findContrastColorAgainstDark(t,e){let r=t;const n=r.a,s=c.rgb.hsv(r.toRGB());let i=s[2],a=100,o=0;for(;o<15&&a-i>l;){const t=(i+a)/2;s[2]=t;const l=c.hsv.rgb(s);r=Color.colorFromRGB(l,n),h.calculateContrast(r,e)>60?a=t:i=t,o++}s[2]=a;const u=c.hsv.rgb(s);return Color.colorFromRGB(u,n)}findContrastColorAgainstLight(t,e){let r=t;const n=r.a,s=c.rgb.hsv(r.toRGB());let i=0,a=s[2],o=0;for(;o<15&&a-i>l;){const t=(i+a)/2;s[2]=t;const l=c.hsv.rgb(s);r=Color.colorFromRGB(l,n),h.calculateContrast(r,e)>60?i=t:a=t,o++}s[2]=i;const u=c.hsv.rgb(s);return Color.colorFromRGB(u,n)}}var text_stacker_service_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class TextStackerImpl{constructor(t,e,r){this.config=t,this.textMeasurement=e,this.tokenSequenceFactory=r}process(t,e){return text_stacker_service_awaiter(this,void 0,void 0,(function*(){return Promise.all(t.map((t=>this.processBlock(t,e))))}))}processBlock(t,e){return text_stacker_service_awaiter(this,void 0,void 0,(function*(){const r=yield this.tokenSequenceFactory.create(t,{language:e.targetLanguage});let n=this.config.textSizer.minTextSize,s=this.config.textSizer.maxTextSize,i=[];for(;Math.abs(s-n)>this.config.textSizer.precision;){const e=(n+s)/2,a=this.makeAttempt(e,t.boxes,r);!a||a.pointer<r.length?s=e:(n=e,a.result&&(i=a.result))}return new Block(Object.assign(Object.assign({},t),{boxes:i}))}))}makeAttempt(t,e,r){const n=[];let s=0;for(const i of e){const e=this.estimate(i,t,r,s);if(-1===e)return;n.push(new Box(Object.assign(Object.assign({},i),{textSize:t,translation:r.serialize(s,e)}))),s=e+1}return{result:n,pointer:s}}estimate(t,e,r,n=0){let s=n;for(const[i,a]of r.values(n)){const r=this.textMeasurement.getTextBounds(a,{size:e}),n=this.textMeasurement.xHeight({size:e}),o=t.polyCoefs?t.polyCoefs.hh*this.config.textSizer.xHeightRatio:t.height;if(r.width>t.width||n>o)return 0===i?-1:s;s=i}return s}}class ColorExtractorImpl{extract(t,e,r){if(!e.length)return;const{width:n,height:s}=t,i=[],a=[],o=[];for(const c of e){const e=this.restorePointCoordinatesToOriginal(c,n,s,r),l=4*(e.y*n+e.x);i.push(t.data[l]),a.push(t.data[l+1]),o.push(t.data[l+2])}return new Color({r:median(i),g:median(a),b:median(o)})}restorePointCoordinatesToOriginal(t,e,r,n){switch(n){case 90:return new Point({x:e-t.y-1,y:t.x});case 180:return new Point({x:e-t.x-1,y:r-t.y-1});case 270:return new Point({x:t.y,y:r-t.x-1})}return t}}class Exception extends Error{constructor(t,e){super(t),this.name=this.constructor.name,this.additional=e}}class ErrorHandlerImpl{constructor(t,e){this.config=t,this.logger=e}handleError(t){var e,r;this.isAbort(t)?this.logger.log("Abort",t):(this.logger.error(this.isKnownException(t)?"Caught error":"Uncaught error",t),null===(r=null===(e=this.config.events)||void 0===e?void 0:e.onError)||void 0===r||r.call(e,t))}isKnownException(t){return t instanceof Exception}isAbort(t){return t instanceof Error&&"AbortError"===t.name}}class EventEmitterImpl{constructor(){this.handlers={}}off(t,e){this.handlers[t]&&(this.handlers[t]=this.handlers[t].filter((t=>t!==e)))}on(t,e){this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)}emit(t,e){this.handlers[t]&&this.handlers[t].forEach((t=>t(e)))}}class Hyphenator{constructor(t){this.fn=t}split(t){return this.fn(t)}}var hyphenator_factory_service_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class HyphenatorFactoryImpl{constructor(t){this.logger=t}create(t){return hyphenator_factory_service_awaiter(this,void 0,void 0,(function*(){try{const e=yield this.getHyphenatePackage(t);if(!e)return this.createDummy();return new Hyphenator((t=>e.hyphenateSync(t,{hyphenChar:"·"}).split("·")))}catch(e){return this.logger.warn(`Unable to fetch hyphenate package for ${t}, falling back to dummy`),this.createDummy()}}))}createDummy(){return new Hyphenator((t=>[t]))}getHyphenatePackage(t){return hyphenator_factory_service_awaiter(this,void 0,void 0,(function*(){switch(t){case"ru":return __webpack_require__.e(989).then(__webpack_require__.t.bind(__webpack_require__,1822,23));case"en":return __webpack_require__.e(731).then(__webpack_require__.t.bind(__webpack_require__,9733,23));case"be":return __webpack_require__.e(44).then(__webpack_require__.t.bind(__webpack_require__,6415,23));case"uk":return __webpack_require__.e(357).then(__webpack_require__.t.bind(__webpack_require__,8566,23));case"it":return __webpack_require__.e(69).then(__webpack_require__.t.bind(__webpack_require__,8576,23));case"de":return __webpack_require__.e(487).then(__webpack_require__.t.bind(__webpack_require__,10,23));case"es":return __webpack_require__.e(737).then(__webpack_require__.t.bind(__webpack_require__,6659,23));case"fr":return __webpack_require__.e(107).then(__webpack_require__.t.bind(__webpack_require__,2151,23))}}))}}var image_translator_service_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class ImageTranslatorImpl{constructor(t,e,r,n,s){this.config=t,this.ocrApiClient=e,this.translateApiClient=r,this.layout=n,this.blockProcessor=s}recognize(t){return image_translator_service_awaiter(this,void 0,void 0,(function*(){const{image:e,language:r,autoRotate:n}=t;return yield this.ocrApiClient.recognize(e,r,n)}))}translate(t){return image_translator_service_awaiter(this,void 0,void 0,(function*(){const{blocks:e,sourceLanguage:r,targetLanguage:n}=t,s=this.preprocessBlocks(e),i=yield this.translateApiClient.translate({blocks:s,sourceLanguage:r,targetLanguage:n});return yield this.blockProcessor.process(i,{targetLanguage:n})}))}render(t){const{image:e,blocks:r,resultScale:n,resultRotate:s,additionalRotate:i,erasedImage:a,language:o,scale:c,mode:l="translation",showResult:h=!0}=t,u=this.preprocessBlocks(r),d=this.config.rendering.svgBasedRenderingLanguages.includes(o);this.layout.reset(),this.layout.setImage(e,i),this.layout.setResultScale(n),this.layout.setResultRotate(s||0),this.layout.setTextRenderingMode(d?"svg":"canvas"),this.layout.setResultVisibility(h),this.layout.setRenderingMode(l),this.layout.setRotate(i),a&&this.layout.setErasedImage(a,e.naturalWidth/a.naturalWidth),this.layout.setBlocks(u),this.layout.render(),this.layout.updateScale(c||1)}addListener(t,e){this.layout.addListener(t,e)}removeListener(t,e){this.layout.removeListener(t,e)}preprocessBoxes(t){return t.map((t=>{const e=t.words.map((t=>new Word(Object.assign(Object.assign({},t),{polyCoefs:t.polyCoefs?new PolyCoefs(t.polyCoefs):void 0})))),r=new Color(t.backgroundColor),n=new Color(t.textColor),s=t.polyCoefs?new PolyCoefs(t.polyCoefs):void 0,i=new Color(t.outlineColor);return new Box(Object.assign(Object.assign({},t),{words:e,backgroundColor:r,textColor:n,outlineColor:i,polyCoefs:s}))}))}preprocessBlocks(t){return t.map((t=>new Block(Object.assign(Object.assign({},t),{boxes:this.preprocessBoxes(t.boxes)}))))}updateScaleValue(t){this.layout.updateScale(t)}setResultVisibility(t){this.layout.setResultVisibility(t)}setBlocksHighlighting(t){this.layout.setBlocksHighlighting(t)}setRenderingMode(t){this.layout.setRenderingMode(t)}setRotate(t){this.layout.setRotate(t)}reset(){this.layout.reset()}}class InputHandlerBase{constructor(t,e){this.canvas=t,this.eventEmitter=e,this.bindEvents()}on(t,e){this.eventEmitter.on(t,e)}}class InputHandlerDesktopImpl extends InputHandlerBase{constructor(){super(...arguments),this.isDragging=!1,this.startX=0,this.startY=0}get xMultiplier(){return this.canvas.width/this.canvas.clientWidth}get yMultiplier(){return this.canvas.height/this.canvas.clientHeight}bindEvents(){this.canvas.addEventListener("wheel",(t=>this.handleWheel(t))),this.canvas.addEventListener("mousedown",(t=>this.handleMouseDown(t))),this.canvas.addEventListener("mousemove",(t=>this.handleMouseMove(t))),this.canvas.addEventListener("mouseup",(t=>this.handleMouseUp(t))),this.canvas.addEventListener("mouseleave",(t=>this.handleMouseUp(t)))}handleMouseDown(t){t.preventDefault(),0===t.button&&(this.isDragging=!0,this.startX=t.clientX,this.startY=t.clientY,this.eventEmitter.emit("moveStart",this.getCursorPoint(t)))}handleMouseMove(t){t.preventDefault(),this.isDragging&&(this.eventEmitter.emit("move",Object.assign(Object.assign({},this.getCursorPoint(t)),{dx:(t.clientX-this.startX)*this.xMultiplier,dy:(t.clientY-this.startY)*this.yMultiplier})),this.startX=t.clientX,this.startY=t.clientY)}handleMouseUp(t){t.preventDefault(),0===t.button&&(this.isDragging=!1,this.eventEmitter.emit("moveEnd",this.getCursorPoint(t)))}handleWheel(t){t.preventDefault();const e=t.deltaY>0?-.05:.05,r=Math.max(1,Math.abs(t.deltaY/50))*e;this.eventEmitter.emit("zoom",{value:r,center:this.getCursorPoint(t)})}getCursorPoint(t){const e=this.canvas.getBoundingClientRect();return new Point({x:(t.clientX-e.left)*this.xMultiplier,y:(t.clientY-e.top)*this.yMultiplier})}}class InputHandlerTouchImpl{get xMultiplier(){return this.canvas.width/this.canvas.clientWidth}get yMultiplier(){return this.canvas.height/this.canvas.clientHeight}constructor(t,e){this.canvas=t,this.eventEmitter=e,this.isDragging=!1,this.startX=0,this.startY=0,this.timer=null,this.bindEvents()}on(t,e){this.eventEmitter.on(t,e)}bindEvents(){this.canvas.addEventListener("touchstart",(t=>this.handleTouchStart(t))),this.canvas.addEventListener("touchmove",(t=>this.handleTouchMove(t))),this.canvas.addEventListener("touchend",(t=>this.handleTouchEnd(t))),this.canvas.addEventListener("touchcancel",(t=>this.handleTouchEnd(t)))}handleTouchStart(t){if(t.preventDefault(),this.lastTouches=t.touches,1===t.touches.length){const e=t.touches[0];this.isDragging=!0,this.startX=e.clientX,this.startY=e.clientY,this.eventEmitter.emit("dragStart",{x:e.clientX,y:e.clientY})}}handleTouchMove(t){if(t.preventDefault(),1===t.touches.length&&this.isDragging){const e=t.touches[0];this.eventEmitter.emit("move",{dx:(e.clientX-this.startX)*this.xMultiplier,dy:(e.clientY-this.startY)*this.yMultiplier}),this.startX=e.clientX,this.startY=e.clientY}else if(t.touches.length>1&&this.lastTouches&&this.lastTouches.length>1){const e=this.calculateDistance(t.touches[0],t.touches[1])/this.calculateDistance(this.lastTouches[0],this.lastTouches[1])-1,r=(t.touches[0].clientX+t.touches[1].clientX)/2,n=(t.touches[0].clientY+t.touches[1].clientY)/2,s=this.canvas.getBoundingClientRect();this.eventEmitter.emit("zoom",{value:e,center:{x:(r-s.left)*this.xMultiplier,y:(n-s.top)*this.yMultiplier}})}this.lastTouches=t.touches}handleTouchEnd(t){t.preventDefault(),0===t.touches.length&&(null===this.timer?this.timer=window.setTimeout((()=>{this.timer=null,this.isDragging=!1,this.eventEmitter.emit("dragEnd",{x:this.startX,y:this.startY})}),200):(window.clearTimeout(this.timer),this.timer=null,this.handleDoubleClick()))}handleDoubleClick(){const t=this.canvas.getBoundingClientRect();this.eventEmitter.emit("dblClickZoom",{value:2,center:{x:(this.startX-t.left)*this.xMultiplier,y:(this.startY-t.top)*this.yMultiplier}})}calculateDistance(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.hypot(r,n)}}class Canvas{constructor(t,e){let r;if(this.element=t||document.createElement("canvas"),r=(this.element,HTMLCanvasElement,this.element.getContext("2d",{willReadFrequently:e})),!r)throw new Error("Unable to get canvas context");this.context=r}get isObservable(){return this.element instanceof HTMLCanvasElement}get width(){return this.element.width}get height(){return this.element.height}setSizes(t,e){this.element.width=t,this.element.height=e}clear(){this.context.clearRect(0,0,this.width*window.devicePixelRatio,this.height*window.devicePixelRatio)}}class Matrix{constructor(){this.matrix=new DOMMatrix}translate(t,e){return this.matrix.translateSelf(t,e),this}scale(t){return this.matrix.scaleSelf(t,t),this}rotate(t,e){if(e){const r=t%180==0;this.matrix.translateSelf(e.x,e.y),this.matrix.rotateSelf(t),this.matrix.translateSelf(r?-e.x:-e.y,r?-e.y:-e.x)}else this.matrix.rotateSelf(t);return this}multiply(t){return this.matrix.multiplySelf(t.matrix),this}invert(){return this.matrix.invertSelf(),this}getValue(){return[this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f]}toString(){return this.matrix.toString()}reset(){return this.matrix=new DOMMatrix,this}transformPoint(t){return new Point(this.matrix.transformPoint(t))}}var rgb_image_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class RgbImage extends Canvas{constructor(t){super(),this.grayscale=!1,this.scale=1,this.image=t,this.element.width=t.naturalWidth,this.element.height=t.naturalHeight}setScale(t){return this.scale=t,this.setSizes(this.width*t,this.height*t),this}setGrayscale(t){return this.grayscale=t,this}toBlob(t,e){return rgb_image_awaiter(this,void 0,void 0,(function*(){if(this.draw(),this.element instanceof OffscreenCanvas){return yield this.element.convertToBlob({type:this.getSupportedOutputFormat(t),quality:e})}return new Promise(((r,n)=>{this.element instanceof HTMLCanvasElement&&this.element.toBlob((t=>{t?r(t):n(new Error("Failed to create blob from canvas"))}),this.getSupportedOutputFormat(t),e)}))}))}toDataURL(t,e){return rgb_image_awaiter(this,void 0,void 0,(function*(){if(this.draw(),this.element instanceof HTMLCanvasElement)return this.element.toDataURL(this.getSupportedOutputFormat(t),e);{const r=yield this.element.convertToBlob({type:this.getSupportedOutputFormat(t),quality:e});return URL.createObjectURL(r)}}))}toImageData(){return this.draw(),this.context.getImageData(0,0,this.width,this.height)}clear(){this.context.clearRect(0,0,this.width,this.height)}draw(){this.clear(),this.context.drawImage(this.image,0,0,this.width,this.height),this.grayscale&&this.grayscaleCanvas()}grayscaleCanvas(){const t=this.context.getImageData(0,0,this.width,this.height),{data:e}=t;for(let t=0;t<e.length;t+=4){const n=(r=[e[t],e[t+1],e[t+2]]).reduce(((t,e)=>t+e),0)/r.length||0;e[t]=e[t+1]=e[t+2]=n}var r;this.context.putImageData(t,0,0)}getSupportedOutputFormat(t){return"image/webp"===t?RgbImage.hasWebpSupport?t:RgbImage.defaultOutputFormat:t}}RgbImage.hasWebpSupport=function hasWebpSupport(){return 0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}(),RgbImage.defaultOutputFormat="image/jpeg";var svg_image_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class SvgImage{constructor(t,e){this.width=t,this.height=e,this.textItems=[]}addText(t){this.textItems.push(t)}midPoint(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}createQuadraticCurve(t,e,r){const n=this.midPoint(t,e),s=this.midPoint(e,r);return`Q ${n.x} ${n.y}, ${s.x} ${s.y}`}buildSvgPath(t){if(0===t.length)return"";const e=t[0],r=t[t.length-1];let n=`M ${e.x} ${e.y}`;for(let e=1;e<t.length-1;e++)n+=this.createQuadraticCurve(t[e-1],t[e],t[e+1]);return n+=` L ${r.x} ${r.y}`,n}serializeTextItem(t,e){const r=this.buildSvgPath(t.points),n=`path-${e}`,s=encodeHtml(t.text);return`<path id="${n}" d="${r}" fill="none" stroke="none" />\n            <text\n                font-size="${t.fontSize}"\n                font-family="${t.fontFamily}" \n                fill="${t.color}"\n            >\n                <textPath href="#${n}">${s}</textPath>\n            </text>`}toString(){const t=this.textItems.map(((t,e)=>this.serializeTextItem(t,e))).join("");return`<svg xmlns="http://www.w3.org/2000/svg" \n            text-rendering="geometricPrecision"\n            shape-rendering="geometricPrecision"\n            image-rendering="optimizeQuality"\n            color-rendering="optimizeQuality"\n            width="${this.width}"\n            height="${this.height}"\n            viewBox="0 0 ${this.width} ${this.height}"\n        >\n            ${t}\n        </svg>`}toImage(){return svg_image_awaiter(this,void 0,void 0,(function*(){return new Promise((t=>{const e=new Blob([this.toString()],{type:"image/svg+xml;charset=utf-8"}),r=new Image;r.src=URL.createObjectURL(e),r.onload=()=>t(r)}))}))}}var async_renderer_queue_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class AsyncRendererQueue{constructor(){this.queue=[],this.isProcessing=!1}get isEmpty(){return!this.queue.length}enqueue(t){this.queue.push(t),this.processQueue()}processQueue(){return async_renderer_queue_awaiter(this,void 0,void 0,(function*(){if(!this.isProcessing){for(this.isProcessing=!0;this.queue.length>0;){const t=this.queue.shift();t&&(yield t())}this.isProcessing=!1}}))}}var base_layer_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class BaseLayer{constructor(t){this.scale=1,this.translate={x:0,y:0},this.rotate=0,this.canvas=t,this.context=t.context}get height(){return this.canvas.height}get width(){return this.canvas.width}getTransform(){return(new Matrix).translate(this.translate.x,this.translate.y).scale(this.scale).rotate(this.rotate)}setScale(t){this.scale=t}setRotate(t){this.rotate=t}setTranslate(t){this.translate=t}move(t,e){this.translate=new Point({x:this.translate.x+t,y:this.translate.y+e})}render(t,e){return base_layer_awaiter(this,void 0,void 0,(function*(){const r=this.context;r&&(r.save(),r.setTransform(...t.getValue()),yield this.draw(e),r.restore())}))}}class SelectionLayer extends BaseLayer{constructor(){super(...arguments),this.points=[]}draw(t){const e=this.context;0!==this.points.length&&(e.save(),e.strokeStyle="rgba(255, 204, 0, 0.4)",e.lineWidth=20,e.lineCap="round",e.lineJoin="round",e.stroke(this.buildPath()),e.restore())}buildPath(){const[t,...e]=this.points,r=new Path2D;r.moveTo(t.x,t.y);for(const t of e)r.lineTo(t.x,t.y);return r}addPoint(t){this.points.push(t)}finalize(){const t=this.points;return this.points=[],t}}var layout_service_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class LayoutImpl{constructor(t,e,r,n,s,i,a,o,c){this.config=e,this.eventEmitter=r,this.logger=n,this.layersFactory=s,this.inputHandler=i,this.inputTouchHandler=a,this.transformManager=o,this.wordsFinder=c,this.viewportWidth=0,this.viewportHeight=0,this.showResult=!0,this.highlightBlocks=!1,this.renderingMode="translation",this.textRenderingMode="canvas",this.enableBackground=!0,this.canvas=new Canvas(t),this.rendererQueue=new AsyncRendererQueue;const l=new ResizeObserver((e=>{for(const r of e){if(!r.contentRect)return;r.contentRect.height===this.viewportHeight&&r.contentRect.width===this.viewportWidth||(this.viewportWidth=t.width,this.viewportHeight=t.height,this.transformManager.updateVieportSize(t.width,t.height),this.render())}}));this.canvas.isObservable&&l.observe(this.canvas.element),this.viewportWidth=t.width,this.viewportHeight=t.height,this.imageLayer=this.layersFactory.createImageLayer(),this.erasedImageLayer=this.layersFactory.createImageLayer(),this.backgroundLayer=this.layersFactory.createBackgroundLayer(),this.textLayer=this.layersFactory.createTextLayer({mode:this.textRenderingMode}),this.wordsLayer=this.layersFactory.createWordsSelectionLayer(),this.debugLayer=this.layersFactory.createDebugLayer(),this.selectionLayer=new SelectionLayer(this.canvas),this.listenInput()}get activeHandler(){if(this.config.input)return"desktop"===this.config.input?this.inputHandler:this.inputTouchHandler}addListener(t,e){this.eventEmitter.on(t,e)}removeListener(t,e){this.eventEmitter.off(t,e)}listenInput(){const t=this.activeHandler;t&&(t.on("zoom",(({value:t,center:e})=>{var r,n;this.transformManager.isAnimationActive||(this.transformManager.zoom(this.transformManager.normalizedScaleValue+t,e),null===(n=(r=this.backgroundLayer).setBlurRatio)||void 0===n||n.call(r,this.transformManager.scaleValue),this.render(),this.eventEmitter.emit("zoom",{zoomValue:this.transformManager.normalizedScaleValue}))})),t.on("moveStart",(({x:t,y:e})=>{this.transformManager.isAnimationActive||(this.selectionLayer.addPoint({x:t,y:e}),this.render())})),t.on("move",(({x:t,y:e,dx:r,dy:n})=>{this.transformManager.isAnimationActive||("translation"===this.renderingMode?this.transformManager.move(r,n):this.selectionLayer.addPoint({x:t,y:e}),this.render())})),t.on("moveEnd",(()=>{if(this.transformManager.isAnimationActive)return;const t=this.transformManager.toResultMatrix().invert(),e=this.selectionLayer.finalize().map((e=>t.transformPoint(e))),r=this.wordsFinder.find(e);this.wordsLayer.select(r),this.render()})),t.on("dblClickZoom",(({value:t,center:e})=>{if(!this.transformManager.isAnimationActive)if(this.transformManager.isScaled){const zoomHandler=()=>{this.render(),this.eventEmitter.emit("zoom",{zoomValue:this.transformManager.normalizedScaleValue})};this.transformManager.fit({zoomCallback:zoomHandler})}else{const zoomHandler=()=>{var t,e;null===(e=(t=this.backgroundLayer).setBlurRatio)||void 0===e||e.call(t,this.transformManager.scaleValue),this.render(),this.eventEmitter.emit("zoom",{zoomValue:this.transformManager.normalizedScaleValue})};this.transformManager.zoom(this.transformManager.normalizedScaleValue+t,e,{zoomCallback:zoomHandler})}})))}get resultLayers(){return[this.backgroundLayer,this.textLayer,this.wordsLayer,this.debugLayer]}reset(){this.showResult=!0,this.highlightBlocks=!1,this.renderingMode="translation",this.textRenderingMode="canvas",this.enableBackground=!0,this.imageLayer=this.layersFactory.createImageLayer(),this.erasedImageLayer=this.layersFactory.createImageLayer(),this.backgroundLayer=this.layersFactory.createBackgroundLayer(),this.textLayer=this.layersFactory.createTextLayer({mode:this.textRenderingMode}),this.wordsLayer=this.layersFactory.createWordsSelectionLayer(),this.debugLayer=this.layersFactory.createDebugLayer(),this.selectionLayer=new SelectionLayer(this.canvas),this.canvas.clear()}setImage(t,e){this.transformManager.init({viewportWidth:this.viewportWidth,viewportHeight:this.viewportHeight,imageWidth:t.naturalWidth,imageHeight:t.naturalHeight,imageRotate:e}),this.imageLayer.setImage(t)}setErasedImage(t,e){this.enableBackground=!1,this.erasedImageLayer.setImage(t),this.erasedImageLayer.setScale(e)}updateScale(t){var e,r;if(this.canvas.element instanceof OffscreenCanvas)return;const n=this.canvas.element.getBoundingClientRect();this.transformManager.zoom(t,{x:n.width/2,y:n.height/2}),null===(r=(e=this.backgroundLayer).setBlurRatio)||void 0===r||r.call(e,this.transformManager.scaleValue),this.render()}setResultScale(t){this.transformManager.setResultScale(t)}setBlocks(t){this.resultLayers.forEach((e=>e.setBlocks(t))),this.wordsFinder.setBlocks(t)}setBlocksHighlighting(t){this.highlightBlocks=t,this.render()}setResultVisibility(t){this.showResult=t,this.render()}setRenderingMode(t){this.renderingMode=t,this.render()}setTextRenderingMode(t){this.textRenderingMode=t}highlightWords(t){this.wordsLayer.select(t),this.render()}setResultRotate(t){this.transformManager.setResultRotate(t),this.render()}setRotate(t){this.transformManager.setRotate(t),this.render()}getLayers(){return[{layer:this.imageLayer,isVisible:()=>!0,getTransform:()=>this.transformManager.toImageMatrix()},{getTransform:()=>this.transformManager.toImageMatrix(),layer:this.erasedImageLayer,isVisible:()=>this.showResult&&"translation"===this.renderingMode&&!this.enableBackground},{getTransform:()=>this.transformManager.toResultMatrix(),layer:this.backgroundLayer,isVisible:()=>this.showResult&&"translation"===this.renderingMode&&this.enableBackground},{getTransform:()=>this.transformManager.toResultMatrix(),layer:this.textLayer,isVisible:()=>this.showResult&&"translation"===this.renderingMode},{getTransform:()=>this.transformManager.toResultMatrix(),layer:this.wordsLayer,isVisible:()=>this.showResult&&"words"===this.renderingMode},{getTransform:()=>this.transformManager.toResultMatrix(),layer:this.debugLayer,isVisible:()=>this.highlightBlocks},{getTransform:()=>new Matrix,layer:this.selectionLayer,isVisible:()=>!0}]}render(){this.rendererQueue.enqueue(this.draw.bind(this))}draw(){return layout_service_awaiter(this,void 0,void 0,(function*(){this.canvas.clear();const t=this.getLayers().filter((({isVisible:t})=>t()));try{const e=this.transformManager.getVisibleBounds();for(const{layer:r,getTransform:n}of t)yield r.render(n().multiply(r.getTransform()),e)}catch(t){this.logger.error(t)}}))}}class BackgroundLayerImpl extends BaseLayer{constructor(t,e){super(t),this.blurRatio=1,this.config=e}setBlocks(t){this.blocks=t}setBlurRatio(t){this.blurRatio=t}draw(t){const e=this.context;if(!this.blocks)return;e.filter=`blur(${this.config.rendering.blurRadius*this.blurRatio}px)`;this.blocks.flatMap((t=>t.boxes)).filter((e=>e.intersectsByPolyCoeffs(t,this.config.rendering.boxWidthRatio))).forEach((t=>this.drawBox(t)))}drawBox(t){const e=this.context,r=t.backgroundColor.toRgba();if(t.polyCoefs){e.strokeStyle=r,e.lineWidth=t.polyCoefs.hh*this.config.rendering.boxHeightRatio;const n=this.createNodePath(t,t.polyCoefs);e.stroke(n)}else e.fillStyle=r,e.fillRect(...t.getValue())}createNodePath(t,e){const r=new Path2D,n=e.hh*this.config.rendering.boxWidthRatio,s=(e.fromXtoY?t.x:t.y)-n,i=((e.fromXtoY?t.width:t.height)+2*n)/this.config.rendering.pathSegmentCount;for(let t=0;t<=this.config.rendering.pathSegmentCount;t++){const n=s+i*t,a=e.calcValue(n);0===t?r.moveTo(n,a):r.lineTo(n,a)}return r}}class DebugLayerImpl extends BaseLayer{setBlocks(t){this.blocks=t}draw(t){var e;null===(e=this.blocks)||void 0===e||e.forEach(((e,r)=>this.drawBlock(e,r,t)))}drawBlock(t,e,r){const n=`hsl(${60*e%360}, 100%, 50%)`;t.boxes.filter((t=>t.intersects(r))).forEach((t=>this.drawBox(t,n)))}drawBox(t,e){const r=this.context;r.save(),r.filter="none",r.strokeStyle=e,r.lineWidth=1,r.strokeRect(...t.getValue()),r.restore()}}class ImageLayerImpl extends BaseLayer{setImage(t){this.image=t}draw(t){const e=this.context;this.image&&e.drawImage(this.image,0,0)}}class TextLayerImpl extends BaseLayer{constructor(t,e,r){super(t),this.config=e,this.textMeasurement=r}setBlocks(t){this.blocks=t}draw(t){if(!this.blocks)return;this.blocks.flatMap((t=>t.boxes)).filter((e=>e.intersects(t))).forEach((t=>this.drawBox(t)))}drawBox(t){const e=this.context;t.text&&(t.width<this.config.rendering.minTextSize||t.height<this.config.rendering.minTextSize||(t.polyCoefs?this.drawTextOnPath(t.translation,t.x,t.y,t.polyCoefs,t.textColor,t.textSize,t.outlineColor):e.fillText(t.translation,t.x,t.centerY())))}drawTextOnPath(t,e,r,n,s,i=this.config.rendering.defaultTextSize,a){const o=this.context,c=n.fromXtoY?e:r,l=this.textMeasurement.ascent({size:i}),h=l-(l+this.textMeasurement.descent({size:i}))/2;o.font=`${i}px ${this.config.rendering.font}`,o.fillStyle=s.toRgba(),o.strokeStyle=a.toRgba();for(let e=0;e<t.length;e++){const{height:r}=this.textMeasurement.getTextBounds(t,{size:i}),s=t.slice(0,e),{width:a}=this.textMeasurement.getTextBounds(s,{size:i}),l=c+a,u=n.calcValue(l),d=n.calcTextAngle(l);o.save(),o.translate(l,u+h),o.rotate(d),o.lineWidth=this.getLineWidth(r),this.config.experiments.useBlurTextErasure&&o.strokeText(t[e],0,0),o.fillText(t[e],0,0),o.restore()}}getLineWidth(t){return.02*t*this.config.rendering.textStrokeSize}}var text_svg_layer_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class TextSvgLayerImpl extends BaseLayer{constructor(t,e,r){super(t),this.config=e,this.textMeasurement=r}setBlocks(t){this.blocks=t}draw(){return text_svg_layer_awaiter(this,void 0,void 0,(function*(){const t=this.context;if(!this.blocks)return;const e=this.blocks.flatMap((t=>t.boxes)),r=new SvgImage(this.width/this.scale,this.height/this.scale);for(const t of e){const e=this.createPoints(t);r.addText({points:e,text:t.translation,fontFamily:this.config.rendering.font,fontSize:t.textSize||this.config.rendering.defaultTextSize,color:t.textColor.toRgba()})}const n=yield r.toImage();t.drawImage(n,0,0)}))}createPoints(t){const e=t.polyCoefs;if(!e)return[];const r=[],n=e.fromXtoY?t.x:t.y,s=e.fromXtoY?t.width:t.height,i=this.textMeasurement.ascent({size:t.textSize}),a=i-(i+this.textMeasurement.descent({size:t.textSize}))/2,o=s/this.config.rendering.pathSegmentCount;for(let t=0;t<=this.config.rendering.pathSegmentCount;t++){const s=n+o*t,i=e.calcValue(s)+a,c=new Point({x:s,y:i});r.push(c)}return r}}class WordsLayerImpl extends BaseLayer{constructor(t,e){super(t),this.selectedWords=[],this.config=e}setBlocks(t){this.blocks=t}select(t){this.selectedWords=t}draw(t){var e;null===(e=this.blocks)||void 0===e||e.forEach((e=>this.drawBlock(e,t)))}drawBlock(t,e){t.boxes.forEach((t=>this.drawBox(t,e)))}drawBox(t,e){t.words.filter((t=>t.intersects(e))).forEach((t=>this.drawWord(t)))}drawWord(t){const e=this.selectedWords.includes(t)?this.config.rendering.wordHighlightColor:this.config.rendering.wordColor,r=this.context;if(t.polyCoefs){r.strokeStyle=e,r.lineWidth=t.polyCoefs.hh;const n=this.createNodePath(t,t.polyCoefs);r.stroke(n)}else r.fillStyle=e,r.fillRect(...t.getValue())}createNodePath(t,e){const r=new Path2D,n=e.fromXtoY?t.x:t.y,s=(e.fromXtoY?t.width:t.height)/this.config.rendering.pathSegmentCount;for(let t=0;t<=this.config.rendering.pathSegmentCount;t++){const i=n+s*t,a=e.calcValue(i);0===t?r.moveTo(i,a):r.lineTo(i,a)}return r}}class LayersFactoryImpl{constructor(t,e,r){this.config=e,this.textMeasurement=r,this.canvas=new Canvas(t)}createImageLayer(){return new ImageLayerImpl(this.canvas)}createBackgroundLayer(){return new BackgroundLayerImpl(this.canvas,this.config)}createDebugLayer(){return new DebugLayerImpl(this.canvas)}createTextLayer(t){switch(t.mode){case"canvas":return new TextLayerImpl(this.canvas,this.config,this.textMeasurement);case"svg":return new TextSvgLayerImpl(this.canvas,this.config,this.textMeasurement)}}createWordsSelectionLayer(){return new WordsLayerImpl(this.canvas,this.config)}}class LoggerImpl{constructor(t){this.config=t}log(...t){this.config.logging.enabled&&console.log(...t)}warn(...t){this.config.logging.enabled&&console.warn(...t)}error(...t){this.config.logging.enabled&&console.error(...t)}time(t){this.config.logging.enabled&&console.time(t)}timeEnd(t){this.config.logging.enabled&&console.timeEnd(t)}}class OcrException extends Exception{constructor(t,e){super(t,e),this.source="ocr"}}class ExpiredSessionException extends OcrException{}class EmptyResultException extends OcrException{constructor(t){super("EmptyResultException",t)}}var ocr_api_client_service_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class OcrApiClientImpl{constructor(t,e,r){this.config=t,this.logger=e,this.ocrBlocksBuilder=r}recognize(t,e="*",r=!0){var n,s,i;return ocr_api_client_service_awaiter(this,void 0,void 0,(function*(){const a=this.buildRgbImage(t),o=yield a.toBlob(this.config.ocr.imageFormat,this.config.ocr.imageQuality),c=yield a.toDataURL("image/jpeg",1);null===(s=(n=this.config.ocr).onImageSend)||void 0===s||s.call(n,c);const l=this.buildUrlParams(e,r),h=`${this.config.ocr.endpoint}?${l.toString()}`,u=new FormData;u.append("file",o);const d=Date.now(),g=yield fetch(h,{method:"POST",body:u});if(403===g.status)throw new ExpiredSessionException;if(!g.ok){const t=yield g.text();throw new OcrException(t)}const p=yield g.json(),f=Date.now()-d;if(!p.data.detected_lang||0===p.data.blocks.length)throw new EmptyResultException({requestId:p.request_id,duration:f});this.logger.log("Received OCR API response:",p);const m=null!==(i=p.data.rotate)&&void 0!==i?i:0,y={duration:f,requestId:p.request_id,blocks:this.processBlocks(p.data,a),scale:1/a.scale,rotate:this.normalizeAngle(m),language:p.data.detected_lang};return p.data.erased_image&&(y.erasedImage=yield this.fetchErasedImage(p.data.erased_image)),y}))}fetchErasedImage(t){return ocr_api_client_service_awaiter(this,void 0,void 0,(function*(){return new Promise((e=>{const r=`${this.config.ocr.erasedImagesHost}/${t}`,n=new Image;n.addEventListener("load",(()=>e(n))),n.addEventListener("error",(()=>e(void 0))),n.crossOrigin="anonymous",n.src=r}))}))}normalizeAngle(t){return(360-t)%360}buildUrlParams(t,e){const r=this.config.experiments.isLLMTranslationEnabled&&("*"===t||"en"===t),n=new URLSearchParams({srv:this.config.ocr.srv,lang:t});if(e&&(n.set("rotate","auto"),n.set("rotateColorCoordinates","true")),this.config.ocr.sid&&n.set("sid",this.config.ocr.sid),this.config.experiments.useBlurTextErasure&&n.set("eraseText","true"),r&&n.set("reorder","true"),this.config.ocr.customRecognizeEndpoint&&n.set("custom_recognize_url",this.config.ocr.customRecognizeEndpoint),this.config.ocr.queryParams)for(const[t,e]of Object.entries(this.config.ocr.queryParams))n.set(t,e);return n}buildRgbImage(t){const e=new RgbImage(t),r=Math.min(this.config.ocr.maxImageWidth/t.width,1);return e.setScale(r),this.config.ocr.grayscale&&e.setGrayscale(!0),e}processBlocks(t,e){const r=e.setGrayscale(!1).toImageData();return this.ocrBlocksBuilder.build(t,r)}}class OcrBlocksBuilderImpl{constructor(t){this.colorExtractor=t}build(t,e){var r;const n=null!==(r=t.rotate)&&void 0!==r?r:0;return t.blocks.map((t=>new Block({x:t.x,y:t.y,width:t.w,height:t.h,boxes:t.boxes.map((t=>this.buildBox(t,e,n))),columnIndex:t.column_index})))}buildBox(t,e,r){var n,s;const i=(null===(n=t.textColor)||void 0===n?void 0:n.Points)&&this.colorExtractor.extract(e,t.textColor.Points,r),a=(null===(s=t.backgroundColor)||void 0===s?void 0:s.Points)&&this.colorExtractor.extract(e,t.backgroundColor.Points,r);return new Box({x:t.x,y:t.y,width:t.w,height:t.h,polyCoefs:t.polyCoefs&&new PolyCoefs(t.polyCoefs),text:t.text,textColor:i,backgroundColor:a,words:t.words.map((t=>this.buildWord(t)))})}buildWord(t){return new Word({x:t.x,y:t.y,width:t.w,height:t.h,text:t.text,polyCoefs:t.polyCoefs&&new PolyCoefs(t.polyCoefs)})}}class OcrTranslateAdapterImpl{extractTexts(t){const e=[];for(const r of t){if(!r.boxes)continue;const t=r.boxes.filter((t=>t.text)).map((t=>t.text)),n=this.joinLines(t.map((t=>encodeHtml(t))));e.push(n)}return e}applyTexts(t,e){return t.map(((t,r)=>{if(!t.boxes)return t;const n=this.fixHangingPunctiuation(e[r]),s=this.splitLine(n).map((t=>decodeHtml(t))),i=t.boxes.map(((t,e)=>new Box(Object.assign(Object.assign({},t),{translation:s[e]}))));return new Block(Object.assign(Object.assign({},t),{boxes:i}))}))}fixHangingPunctiuation(t){return t.replace(/\s?<wbr>\s?([.,!?:;-])/,"$1<wbr>")}joinLines(t){return t.join(" <wbr> ")}splitLine(t){return t.split(/\s?<wbr>\s?/gi)}}class OcrTranslateAdapterWithLLMImpl extends OcrTranslateAdapterImpl{extractTexts(t){var e;const r=[],n=new Map;for(const r of t){if(!r.boxes||void 0===r.columnIndex||null===r.columnIndex)continue;const t=r.boxes.filter((t=>t.text)).map((t=>t.text)),s=this.joinLines(t.map((t=>encodeHtml(t))));n.has(r.columnIndex)?null===(e=n.get(r.columnIndex))||void 0===e||e.push(s):n.set(r.columnIndex,[s])}return n.forEach((t=>{r.push(this.joinColums(t))})),r}applyTexts(t,e){const r=[];return e.map((t=>{const e=this.decodeHTMLEntities(t);r.push(...this.splitColums(e))})),t.map(((t,e)=>{if(!t.boxes)return t;const n=this.fixHangingPunctiuation(r[e]),s=this.splitLine(n).map((t=>decodeHtml(t))),i=t.boxes.map(((t,e)=>new Box(Object.assign(Object.assign({},t),{translation:s[e]}))));return new Block(Object.assign(Object.assign({},t),{boxes:i}))}))}joinColums(t){return t.join(" <br> ")}splitColums(t){return t.split(/\s?<br>\s?/gi)}decodeHTMLEntities(t){return t.replace(/&#x([a-fA-F0-9]+);|&#([0-9]+);/g,((t,e,r)=>e?String.fromCharCode(parseInt(e,16)):r?String.fromCharCode(parseInt(r,10)):t))}}class TextMeasurementImpl extends Canvas{constructor(t){super(),this.cache=new Map,this.config=t}ascent(t={}){return this.getTextMetrics(t).fontAscent}descent(t={}){return this.getTextMetrics(t).fontDescent}getTextBounds(t,e={}){const r=this.getTextMetrics(e,t);return{width:r.width,height:r.actualAscent+r.actualDescent}}xHeight(t){return this.getTextBounds("x",t).height}buildFontString(t){const{size:e=this.config.rendering.defaultTextSize,font:r=this.config.rendering.font}=t;return`normal ${e}px ${r}`}getTextMetrics(t,e=""){const r=this.buildFontString(t),n=`${e}:${r}`,s=this.cache.get(n);if(s)return s;this.context.save(),this.context.font=r;const i=this.context.measureText(e);this.context.restore();const a={actualAscent:Math.abs(i.actualBoundingBoxAscent),actualDescent:Math.abs(i.actualBoundingBoxDescent),fontAscent:i.fontBoundingBoxAscent,fontDescent:i.fontBoundingBoxDescent,width:i.width};return this.cache.set(n,a),a}}const g=Symbol.for("word-break"),p=Symbol.for("syllable-break");class TokenSequence{constructor(t){this.tokens=t}get length(){return this.tokens.length}serialize(t,e){let r="";for(let n=t;n<=e;n++){const s=this.tokens[n];"string"==typeof s?r+=s:(s===g&&n!==t&&(r+=" "),s===p&&n===e&&(r+="-"))}return r}*values(t){for(let e=t;e<this.tokens.length;e++)this.isValidBreak(e)&&(yield[e,this.serialize(t,e)])}isValidBreak(t){const e=this.tokens[t],r=this.tokens[t+1];return t===this.tokens.length-1||e===p||e!==g&&r===g}}var token_sequence_factory_service_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class TokenSequenceFactoryImpl{constructor(t,e,r){this.config=t,this.blocksAnalyzer=e,this.hyphenatorFactory=r}create(t,e){return token_sequence_factory_service_awaiter(this,void 0,void 0,(function*(){let r;this.blocksAnalyzer.isWellFormedBlock(t)&&this.config.hyphenation.enabled&&t.boxes.length>=this.config.hyphenation.minLinesThreshold&&(r=yield this.hyphenatorFactory.create(e.language));const n=t.boxes.flatMap(((t,e,n)=>{const s=this.breakLine(t.translation,r);return e!==n.length-1?[...s,g]:s}));return new TokenSequence(n)}))}breakLine(t,e){return t.split(" ").flatMap(((t,r,n)=>{var s;const i=(null!==(s=null==e?void 0:e.split(t))&&void 0!==s?s:[t]).flatMap(((t,e,r)=>e!==r.length-1?[t,p]:t));return r!==n.length-1?[...i,g]:i}))}}var f=__webpack_require__(4691),m=__webpack_require__.n(f);class TransformManagerImpl{constructor(){this.scale=1,this.translate={x:0,y:0},this.rotate=0,this.viewportWidth=0,this.viewportHeight=0,this.resultRotate=0,this.resultScale=1,this.imageBaseRotate=0,this.imageBaseWidth=0,this.imageBaseHeight=0,this.isAnimationActive=!1}get imageRotate(){return(this.imageBaseRotate+this.rotate)%360}get isLandscape(){return this.imageRotate%180==0}get imageWidth(){return this.isLandscape?this.imageBaseWidth:this.imageBaseHeight}get imageHeight(){return this.isLandscape?this.imageBaseHeight:this.imageBaseWidth}get fitScale(){const t=this.viewportWidth/this.imageWidth,e=this.viewportHeight/this.imageHeight;return Math.min(t,e)}get scaledImageWidth(){return this.imageWidth*this.scale}get fittedImageWidth(){return this.imageWidth*this.fitScale}get scaledImageHeight(){return this.imageHeight*this.scale}get fittedImageHeight(){return this.imageHeight*this.fitScale}get scaleValue(){return this.scale}get normalizedScaleValue(){return this.scale/this.fitScale}get isScaled(){return this.scale!==this.fitScale}init(t){const{imageWidth:e,imageHeight:r,imageRotate:n,viewportWidth:s,viewportHeight:i}=t;this.imageBaseWidth=e,this.imageBaseHeight=r,this.rotate=n,this.viewportWidth=s,this.viewportHeight=i,this.fit()}updateVieportSize(t,e){this.viewportWidth=t,this.viewportHeight=e,this.fit()}fit(t){const e=this.scale,r=this.fitScale,n=t?t.duration||300:1,s=this.translate.x,i=this.translate.y,a={x:(this.viewportWidth-this.fittedImageWidth)/2,y:(this.viewportHeight-this.fittedImageHeight)/2},o=performance.now(),animate=c=>{const l=c-o,h=Math.min(l/n,1);this.scale=e+(r-e)*h,this.translate.x=s+(a.x-s)*h,this.translate.y=i+(a.y-i)*h,null==t||t.zoomCallback(),h<1?requestAnimationFrame(animate):(this.scale=r,this.translate=a,this.isAnimationActive=!1)};this.isAnimationActive||(this.isAnimationActive=!!t,t?requestAnimationFrame(animate):animate(o+n))}zoom(t,e,r){const n=performance.now(),s=r?r.duration||300:1,i=this.scale,a=Math.min(Math.max(t*this.fitScale,this.fitScale),3*this.fitScale)-i,animate=t=>{const o=t-n,c=Math.min(o/s,1),l=i+a*c;this.zoomHandler(l/this.fitScale,e),null==r||r.zoomCallback(),c<1?requestAnimationFrame(animate):this.isAnimationActive=!1};this.isAnimationActive||(this.isAnimationActive=!!r,r?requestAnimationFrame(animate):animate(n+s))}zoomHandler(t,e){const r=this.scale,n=Math.min(Math.max(t*this.fitScale,this.fitScale),3*this.fitScale);if(this.scale=n,n!==this.fitScale){if(e){const t=n/r,s=e.x-t*(e.x-this.translate.x),i=e.y-t*(e.y-this.translate.y);this.move(s-this.translate.x,i-this.translate.y)}}else this.fit()}move(t,e){if(this.scale===this.fitScale)return;const r=this.translate.x+t,n=this.translate.y+e,s=Math.min((this.viewportWidth-this.scaledImageWidth)/2,this.viewportWidth-this.scaledImageWidth),i=Math.min((this.viewportHeight-this.scaledImageHeight)/2,this.viewportHeight-this.scaledImageHeight),a=Math.max(0,(this.viewportWidth-this.scaledImageWidth)/2),o=Math.max(0,(this.viewportHeight-this.scaledImageHeight)/2);this.translate.x=m()(r,s,a),this.translate.y=m()(n,i,o)}reset(){this.scale=1,this.translate={x:0,y:0},this.rotate=0}setScale(t){this.scale=t*this.fitScale}setTranslate(t){this.translate=t}setRotate(t){const e=this.normalizedScaleValue;this.rotate=t,this.zoom(e,{x:this.viewportWidth/2,y:this.viewportHeight/2})}setResultRotate(t){this.resultRotate=360-t}setImageRotate(t){this.imageBaseRotate=t}setResultScale(t){this.resultScale=t}getVisibleBounds(){const t=this.toResultMatrix().invert(),e=[new DOMPoint(0,0),new DOMPoint(this.viewportWidth,0),new DOMPoint(this.viewportWidth,this.viewportHeight),new DOMPoint(0,this.viewportHeight)].map((e=>t.transformPoint(e))),r=e.map((t=>t.x)),n=e.map((t=>t.y)),s=Math.min(...r),i=Math.max(...r),a=Math.min(...n),o=Math.max(...n);return new Rect({x:s,y:a,width:i-s,height:o-a})}toMatrix(){const t=new Point({x:this.imageWidth/2,y:this.imageHeight/2});return(new Matrix).translate(this.translate.x,this.translate.y).scale(this.scale).rotate(this.rotate,t)}toResultMatrix(){const t=new Point({x:this.imageWidth/2,y:this.imageHeight/2});return(new Matrix).translate(this.translate.x,this.translate.y).scale(this.scale).rotate(this.rotate+this.resultRotate,t).scale(this.resultScale)}toImageMatrix(){const t=new Point({x:this.imageWidth/2,y:this.imageHeight/2});return this.toMatrix().rotate(this.imageBaseRotate,t)}}class TranslateException extends Exception{constructor(){super(...arguments),this.source="translate"}}class InvalidSessionException extends TranslateException{}class translate_api_client_exceptions_ExpiredSessionException extends TranslateException{}var translate_api_client_service_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class TranslateApiClientImpl{constructor(t,e,r,n){this.config=t,this.logger=e,this.ocrTranslateAdapter=r,this.ocrTranslateAdapterWithLLM=n,this.requestsCount=0}translate(t){return translate_api_client_service_awaiter(this,void 0,void 0,(function*(){const{blocks:e,sourceLanguage:r,targetLanguage:n}=t,s=this.config.experiments.isLLMTranslationEnabled&&"en"===r&&"ru"===n,i=s?this.ocrTranslateAdapterWithLLM:this.ocrTranslateAdapter,a=i.extractTexts(e),o=this.buildUrlParams(Object.assign(Object.assign(Object.assign({},r&&{source_lang:r}),{target_lang:n}),s&&{tr_model:"llm"})),c=`${this.config.translate.endpoint}?${o.toString()}`,l=new URLSearchParams({options:"0"});for(const t of a)l.append("text",t);const h=yield fetch(c,{method:"POST",body:l});if(405===h.status)throw new InvalidSessionException;if(406===h.status)throw new translate_api_client_exceptions_ExpiredSessionException;if(!h.ok){const t=yield h.text();throw new TranslateException(t)}const u=yield h.json();return this.logger.log("Received Translate API response:",u),i.applyTexts(e,u.text)}))}buildUrlParams(t){const e=new URLSearchParams(Object.assign({srv:this.config.translate.srv,reason:"ocr",id:this.getId(),format:this.config.translate.format},t));if(this.config.translate.queryParams)for(const[t,r]of Object.entries(this.config.translate.queryParams))e.set(t,r);return e}generateSid(){const t=Date.now().toString(16);return t+new Array(16-t.length).fill(null).map((()=>Math.floor(16*Math.random()).toString(16))).join("")}getId(){return`${this.config.translate.sid||this.generateSid()}-${this.requestsCount++}-0`}}var translate_api_client_with_autodetect_service_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class TranslateApiClientWithAutodetectImpl extends TranslateApiClientImpl{translate(t){return translate_api_client_with_autodetect_service_awaiter(this,void 0,void 0,(function*(){const{blocks:e,targetLanguage:r}=t,n=this.ocrTranslateAdapter.extractTexts(e),s=yield Promise.all(n.map((t=>translate_api_client_with_autodetect_service_awaiter(this,void 0,void 0,(function*(){const e=yield this.detectLanguage(t);return yield this.translateText(t,e,r)})))));return this.ocrTranslateAdapter.applyTexts(e,s)}))}translateText(t,e,r){return translate_api_client_with_autodetect_service_awaiter(this,void 0,void 0,(function*(){const n=this.buildUrlParams();e&&n.append("source_lang",e),r&&n.append("target_lang",r);const s=`${this.config.translate.endpoint}?${n.toString()}`,i=new URLSearchParams({options:"0",text:t}),a=yield fetch(s,{method:"POST",body:i});if(!a.ok)throw new Error("Translate API request error");const o=yield a.json();if(!o.text||0===o.text.length)throw new Error("Invalid Translate API response");return this.logger.log("Received Translate API response:",o),o.text[0]}))}detectLanguage(t){return translate_api_client_with_autodetect_service_awaiter(this,void 0,void 0,(function*(){const e=new URLSearchParams({text:this.buildSnippetText(t),srv:this.config.translate.srv,sid:this.generateSid()}),r=`${this.config.translate.detectEndpoint}?${e.toString()}`,n=yield fetch(r);if(!n.ok)throw new Error("Detect API request error");const s=yield n.json();if(s.lang)return this.logger.log("Received Detect API response:",s),s.lang;this.logger.warn("Invalid Detect API response",{response:s,text:t})}))}buildSnippetText(t){return this.stripTags(t).substring(0,1e3)}stripTags(t){return t.replace(/(<([^>]+)>)/gi,"")}}class WordsFinderImpl{constructor(t){this.config=t,this.scale=1}setBlocks(t){this.words=t.flatMap((t=>t.boxes)).flatMap((t=>t.words))}find(t){const e=new Set;for(const r of t){const t=this.findWord(r);t&&e.add(t)}return Array.from(e)}findWord(t){var e;const r=this.config.wordsFinder.tolerance,n=t.x/this.scale,s=t.y/this.scale;return null===(e=this.words)||void 0===e?void 0:e.find((t=>n>=t.x-r&&n<=t.x+t.width+r&&s>=t.y-r&&s<=t.y+t.height+r))}}var y;!function(t){t[t.Canvas=0]="Canvas",t[t.Config=1]="Config",t[t.EventEmitter=2]="EventEmitter",t[t.InputHandler=3]="InputHandler",t[t.InputTouchHandler=4]="InputTouchHandler",t[t.TransformManager=5]="TransformManager",t[t.ErrorHandler=6]="ErrorHandler",t[t.Logger=7]="Logger",t[t.ImageTranslator=8]="ImageTranslator",t[t.OcrTranslateAdapter=9]="OcrTranslateAdapter",t[t.OcrTranslateAdapterWithLLM=10]="OcrTranslateAdapterWithLLM",t[t.OcrApiClient=11]="OcrApiClient",t[t.TranslateApiClient=12]="TranslateApiClient",t[t.Layout=13]="Layout",t[t.LayersFactory=14]="LayersFactory",t[t.BlocksBuilder=15]="BlocksBuilder",t[t.BlocksProcessor=16]="BlocksProcessor",t[t.ColorExtractor=17]="ColorExtractor",t[t.TextContrastEnhancer=18]="TextContrastEnhancer",t[t.TextMeasurement=19]="TextMeasurement",t[t.HyphenatorFactory=20]="HyphenatorFactory",t[t.TextStacker=21]="TextStacker",t[t.TokenSequenceFactory=22]="TokenSequenceFactory",t[t.BlocksFilter=23]="BlocksFilter",t[t.BlocksAnalyzer=24]="BlocksAnalyzer",t[t.WordsFinder=25]="WordsFinder"}(y||(y={}));var src_awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(s,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class Application{constructor(t,s){const i=e()({},r,s);this.container=function buildContainer(t,e){const r=new n.Container;return r.registerValue(y.Canvas,t),r.registerValue(y.Config,e),r.registerClass(y.Logger,LoggerImpl,[y.Config]),r.registerClass(y.EventEmitter,EventEmitterImpl),r.registerClass(y.InputHandler,InputHandlerDesktopImpl,[y.Canvas,y.EventEmitter]),r.registerClass(y.InputTouchHandler,InputHandlerTouchImpl,[y.Canvas,y.EventEmitter]),r.registerClass(y.TransformManager,TransformManagerImpl),r.registerClass(y.ErrorHandler,ErrorHandlerImpl,[y.Config,y.Logger]),r.registerClass(y.ColorExtractor,ColorExtractorImpl),r.registerClass(y.BlocksBuilder,OcrBlocksBuilderImpl,[y.ColorExtractor]),r.registerClass(y.OcrTranslateAdapter,OcrTranslateAdapterImpl),r.registerClass(y.OcrTranslateAdapterWithLLM,OcrTranslateAdapterWithLLMImpl),r.registerClass(y.OcrApiClient,OcrApiClientImpl,[y.Config,y.Logger,y.BlocksBuilder]),r.registerClass(y.TranslateApiClient,e.experiments.detectBlocksLanguage?TranslateApiClientWithAutodetectImpl:TranslateApiClientImpl,[y.Config,y.Logger,y.OcrTranslateAdapter,y.OcrTranslateAdapterWithLLM]),r.registerClass(y.TextMeasurement,TextMeasurementImpl,[y.Config]),r.registerClass(y.LayersFactory,LayersFactoryImpl,[y.Canvas,y.Config,y.TextMeasurement]),r.registerClass(y.Layout,LayoutImpl,[y.Canvas,y.Config,y.EventEmitter,y.Logger,y.LayersFactory,y.InputHandler,y.InputTouchHandler,y.TransformManager,y.WordsFinder]),r.registerClass(y.HyphenatorFactory,HyphenatorFactoryImpl,[y.Logger]),r.registerClass(y.TextStacker,TextStackerImpl,[y.Config,y.TextMeasurement,y.TokenSequenceFactory]),r.registerClass(y.TextContrastEnhancer,TextContrastEnhancerImpl),r.registerClass(y.BlocksProcessor,BlocksProcessorImpl,[y.Config,y.BlocksFilter,y.TextContrastEnhancer,y.TextStacker]),r.registerClass(y.TokenSequenceFactory,TokenSequenceFactoryImpl,[y.Config,y.BlocksAnalyzer,y.HyphenatorFactory]),r.registerClass(y.BlocksFilter,BlocksFilter),r.registerClass(y.BlocksAnalyzer,BlocksAnalyzerImpl,[y.Config,y.Logger]),r.registerClass(y.WordsFinder,WordsFinderImpl,[y.Config]),r.registerClass(y.ImageTranslator,ImageTranslatorImpl,[y.Config,y.OcrApiClient,y.TranslateApiClient,y.Layout,y.BlocksProcessor]),r}(t,i),this.imageTranslator=this.container.resolve(y.ImageTranslator)}recognize(...t){return src_awaiter(this,void 0,void 0,(function*(){return this.imageTranslator.recognize(...t)}))}translate(...t){return src_awaiter(this,void 0,void 0,(function*(){return this.imageTranslator.translate(...t)}))}clearRendererData(){this.imageTranslator.reset()}render(...t){return this.imageTranslator.render(...t)}addListener(t,e){this.imageTranslator.addListener(t,e)}removeListener(t,e){this.imageTranslator.removeListener(t,e)}setResultVisibility(...t){return this.imageTranslator.setResultVisibility(...t)}setBlocksHighlighting(...t){return this.imageTranslator.setBlocksHighlighting(...t)}updateScaleValue(...t){return this.imageTranslator.updateScaleValue(...t)}setRenderingMode(...t){return this.imageTranslator.setRenderingMode(...t)}setRotate(...t){return this.imageTranslator.setRotate(...t)}updateSid(t){this.container.resolve(y.Config).ocr.sid=t}}})(),a=a.default})()));